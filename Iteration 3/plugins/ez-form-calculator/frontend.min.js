var EZFC;"undefined"==typeof EZFC_Object&&(EZFC_Object=function(R){var W=this,u="__HIDDEN__",Y=["in","not_in","selected","not_selected","selected_index","not_selected_index","selected_id","not_selected_id","selected_count","not_selected_count"];this.init=function(){"undefined"==typeof EZFC_LOADED&&(EZFC_LOADED=!0,this.form_vars=[],this.$form_elements=[],this.$element_trigger=0,this.element_trigger_id=0,this.trigger_list=[],this.subtotals=[],this.conditional_once=[],this.payment_form_id=0,this.payment_methods=["stripe","authorize"],this.elements_cache=[],this.group_repeat_elements=[],this.uploaded_files=[],this.skip_init_blur_classes=["ezfc-slider","ezfc-spinner"],this.current_steps=[],this.step_is_changing=!1,this.functions={calculate_element:function(e,t){return W.calculate_element(e,t)},calculate_price:function(e){var t=R(".ezfc-form[data-id='"+e+"']");return W.calculate_price(t)},get_calculated_value_from:function(e,t){return W.get_calculated_element_value(e,t)},get_element_id_by_name:function(e,t){!t&&e&&(t=e);var a=R(".ezfc-form [data-elementname='"+t+"']");if(!a)return!1;if(!(e=e||a.closest(".ezfc-form").data("id")))return!1;for(var i in ezfc_vars.element_vars[e]){var r=ezfc_vars.element_vars[e][i];if(W.get_element_object_value(r,"name","").toLowerCase()==(t=t.toLowerCase()))return r.id}return!1},get_selected_id:function(e){var t;if("number"==typeof e)t=e;else{if("string"!=typeof e)return W.debug_message("Unknown object type: "+e),!1;if(!(t=W.functions.get_element_id_by_name(null,e)))return W.debug_message("Unknown element: "+e),!1}var a=W.functions.get_value_from(t,!0,!0,{return_value:"option_id"});return 1==a.length?a[0]:W.functions.get_value_from(t,!0,!0,{return_value:"option_id"})},get_value_from:function(e,t,a,i){return W.get_value_from_element(null,e,t,a,i)},get_value_from_name:function(e,t,a){var i=W.functions.get_element_id_by_name(e,t);return W.functions.get_value_from(i,a)},price_format:function(e,t,a,i,r){return W.format_price(e,t,a,i,r)}},ezfc_functions=this.functions,this.external_listeners=[],this.price_old_global=[],numeral.register("locale","ezfc",{delimiters:{decimal:ezfc_vars.price_format_dec_point,thousands:ezfc_vars.price_format_dec_thousand},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function(e){var t=e%10;return 1==~~(e%100/10)?"th":1==t?"st":2==t?"nd":3==t?"rd":"th"},currency:{symbol:"$"}}),numeral.locale("ezfc"),this.defaultFormat=ezfc_vars.price_format?ezfc_vars.price_format:"0,0[.][000000]",numeral.defaultFormat(this.defaultFormat),R.datepicker.setDefaults(R.datepicker.regional[ezfc_vars.datepicker_language]),this.init_form_vars(),this.attach_events(),this.init_tips())},this.attach_events=function(){R(document).on("click",".ezfc-element-option-image",function(){R(this).hasClass("ezfc-element-radio-image")?W.radio_change_state(R(this).siblings(".ezfc-element-radio-input")):R(this).hasClass("ezfc-element-checkbox-image")&&W.checkbox_change_state(R(this).siblings(".ezfc-element-checkbox-input"))}),R(document).on("click",".ezfc-element-option-has-image label",function(){var e=R(this).closest(".ezfc-element").data("element"),t=R(this).closest(".ezfc-element-single-option-container").find(":input");"radio"==e?W.radio_change_state(t):"checkbox"==e&&W.checkbox_change_state(t,null,!1,!0)}),R(".ezfc-addon-option").click(function(){R(this).siblings(".ezfc-element-option-image").click()}),R(".ezfc-form").each(function(){var e=R(this),t=e.closest(".ezfc-wrapper");W.init_form_ui(e),t.find(".ezfc-form-loading-text").length&&t.find(".ezfc-form-loading-text").fadeOut(500,function(){e.fadeIn(500,function(){t.removeClass("ezfc-form-loading"),W.form_change(e),W.scroll()})}),R(document).trigger("ezfc_forms_loaded")}),R(".ezfc-element-fileupload").each(function(e,a){var r=R(this).closest(".ezfc-element"),n=r.find(".ezfc-upload-button"),s=r.find(".ezfc-fileupload-files"),o=r.data("id"),t=(R(this).attr("multiple"),R(this).closest(".ezfc-form")),l=t.find("input[name='id']").val(),c=t.find("input[name='ref_id']").val(),i={action:"ezfc_frontend_fileupload",data:"action=upload_file&id="+l+"&ref_id="+c};if("function"!=typeof R.prototype.fileupload)return W.debug_message("Unable to load fileupload function."),!1;R(this).fileupload({formData:i,dataType:"json",add:function(e,t){r.find(".ezfc-bar").css("width",0),r.find(".progress").addClass("active"),r.find(".ezfc-fileupload-message").text(""),n.off("click"),1==W.get_element_object_value(o,"file_upload_auto",1)?W.file_upload_attach_event(a,t,n,e):n.click(function(){W.file_upload_attach_event(a,t,n,e)})},done:function(e,t){if(n.removeAttr("disabled"),t.result.error)return r.find(".ezfc-fileupload-message").text(t.result.error),r.find(".ezfc-bar").css("width",0),!1;for(var a in void 0===W.uploaded_files[l]&&(W.uploaded_files[l]=[]),void 0===W.uploaded_files[l][o]&&(W.uploaded_files[l][o]=[]),t.result)W.uploaded_files[l][o].push({id:t.result[a].success,name:t.files[a].name});R(this).val(""),R(this).attr("multiple")||R(this).attr("disabled","disabled"),r.find(".progress").removeClass("active"),r.find(".ezfc-fileupload-message").text(ezfc_vars.upload_success);var i="";for(var a in W.uploaded_files[l][o])i+="<li class='ezfc-fileupload-files-item' data-fileid='"+W.uploaded_files[l][o][a].id+"' data-refid='"+c+"'>"+W.uploaded_files[l][o][a].name+" <span class='ezfc-fileupload-files-remove'><i class='fa fa-close'></i></span></li>";s.html(i)},progressall:function(e,t){var a=parseInt(t.loaded/t.total*100,10);R(r).find(".ezfc-bar").css("width",a+"%")},replaceFileInput:!1,url:ezfc_vars.ajaxurl})}),R(document).on("click",".ezfc-fileupload-files-remove",function(){var i=R(this);if(i.hasClass("ezfc-state-removing"))return!1;var r=i.closest(".ezfc-form").find("input[name='id']").val(),n=i.closest(".ezfc-element"),s=i.closest(".ezfc-fileupload-files-item"),o=n.find(".ezfc-fileupload-message"),l=n.find(".ezfc-element-fileupload"),c=n.data("id"),_=s.data("fileid"),e=s.data("refid"),t="action=remove_uploaded_file&file_id="+_+"&ref_id="+e;return i.addClass("ezfc-state-removing"),i.find(".fa").removeClass("fa-close").addClass("fa-circle-o-notch fa-spin"),R.ajax({type:"post",url:ezfc_vars.ajaxurl,data:{action:"ezfc_frontend_fileupload",data:t},complete:function(e){var t;if("object"==typeof e&&void 0!==e.responseText)try{t=R.parseJSON(e.responseText)}catch(e){}if(!t)return o.text(e.upload_remove_error),i.find(".fa").removeClass("fa-circle-o-notch fa-spin ezfc-state-removing").addClass("fa-close"),!1;l.attr("multiple")||1==n.find(".ezfc-fileupload-files-item").length&&l.removeAttr("disabled");for(var a in s.fadeOut(),o.text(ezfc_vars.upload_removed),W.uploaded_files[r][c])W.uploaded_files[r][c][a].id==_&&W.uploaded_files[r][c].splice(a,1)}}),!1}),R(".ezfc-overview").dialog({autoOpen:!1,modal:!0}),R(".ezfc-form .ezfc-input-format-listener").each(function(){W.input_format_listener_change(R(this)),R(this).trigger("ezfc_blur_trigger")});var t=this.throttle(function(e,t){var a=e.parents(".ezfc-form");W.form_change(a,null,e,t)},100);R(document).on("change keyup",".ezfc-form input, .ezfc-form select",function(e){t(R(this),e)}),R(document).on("blur",".ezfc-form textarea",function(e){var t=R(this).closest(".ezfc-form");W.form_change(t,null)}),R(".ezfc-element-wrapper-checkbox").change(function(){W.checkbox_change(R(this))}),R(document).on("click",".ezfc-element-wrapper-radio :input",function(){W.radio_change_state(R(this),!0)}),R(".ezfc-slider").each(function(e,t){W.init_slider(R(t))}),R(".ezfc-spinner").each(function(e,t){W.init_spinner(R(t))}),R(document).on("click",".ezfc-step-button",function(){var e=R(this).parents(".ezfc-form"),t=parseInt(e.find(".ezfc-step-active").data("step"))+(R(this).hasClass("ezfc-step-next")?1:-1),a=R(this).hasClass("ezfc-step-next")?1:0;return W.set_step(e,t,a),!1}),R(document).on("click",".ezfc-step-indicator-item-active, .ezfc-step-indicator-item-force",function(){var e=R(this).closest(".ezfc-form"),t=parseInt(R(this).data("step"));return W.set_step(e,t,0),!1}),R(document).on("change",".ezfc-element-wrapper-payment input",function(){var e=R(this).closest(".ezfc-form"),t=e.data("id");1!=W.form_vars[t].price_show_request&&1!=W.form_vars[t].summary_enabled&&W.set_submit_text(e)}),R(window).scroll(this.scroll),this.scroll(),R(".ezfc-form").submit(function(e){var t=R(this),a=t.data("id"),i=t.find(".ezfc-submit");return 1==W.form_vars[a].hard_submit||(W.form_submit(t,-1,i.data("type")),e.preventDefault(),!1)}),R(".ezfc-payment-submit").click(function(e){var t=R(this).closest(".ezfc-payment-form").data("form_id"),a=R(".ezfc-form[data-id='"+t+"']");return W.form_submit(a,-1,R(this).data("payment")),e.preventDefault(),!1}),R(".ezfc-payment-cancel").click(function(){var e=R(this).closest(".ezfc-payment-form").data("form_id"),t=R("#ezfc-form-"+e),a=".ezfc-payment-dialog-modal[data-form_id='"+e+"']";return R(a+=", .ezfc-payment-form").removeClass("ezfc-payment-dialog-open"),W.form_submit(t,!1,!1,!0),!1}),R(".ezfc-reset").click(function(){var e=R(this).parents(".ezfc-form");return W.reset_form(e),!1}),R(".ezfc-collapse-title-wrapper").on("click",function(){var e=R(this).closest(".ezfc-element-wrapper-group");W.toggle_group(e)}),R(".ezfc-cc-number-formatter").on("change keyup",function(){var e=R(this).val();e=e.replace(/[^\dA-Z]/g,"").replace(/(.{4})/g,"$1 ").trim(),R(this).val(e)}),R(document).on("click",".ezfc-table_order-btn",function(e){var t=R("#"+R(this).data("target"));if(t.is(":disabled"))return!1;var a=t.closest(".ezfc-custom-element").closest(".ezfc-form").data("id"),i=t.data("min"),r=t.data("max"),n=R(this).data("value"),s=W.normalize_value(t.val())+n;return 0==r&&(r=s),s=Math.min(s,r),s=Math.max(s,i),t.val(s),t.trigger("blur"),W.form_change(null,a,null,e),!1}),R(document).on("blur",".ezfc-element-table_order-quantity-input",function(e){var t=R(this).closest(".ezfc-custom-element").closest(".ezfc-form").data("id"),a=R(this).data("min"),i=R(this).data("max"),r=W.normalize_value(R(this).val());0==i&&(i=r),r=Math.min(r,i),r=Math.max(r,a),R(this).val(r),W.form_change(null,t,null,e)}),R(document).on("click",".ezfc-repeatable-form-repeat-button",function(){return W.group_repeat(R(this).data("id")),!1}),R(document).on("click",".ezfc-repeatable-form-remove-button",function(){return W.group_remove(R(this).data("id"),R(this).data("row")),!1}),R(".ezfc-form-open-popup-button").click(function(){var e=R(this).data("target");return W.popup_form_open(e),!1}),R(".ezfc-form-popup-close").click(function(){var e=R(this).data("target");return W.popup_form_close(e),!1})},this.init_form_ui=function(e,t){void 0===t&&(t=!0);var s=R(e),o=s.data("id");s.find(".ezfc-element-datepicker").each(function(){var e=R(this),t={};e.data("settings")&&(t=e.data("settings"));var r=[0,1,2,3,4,5,6];t.available_days.length&&(r=t.available_days.split(",")),r=r.map(function(e){return parseInt(e)});var n=[];t.blocked_days.length&&(n=t.blocked_days.split(","));var a=R.trim(W.form_vars[o].datepicker_format);""==a&&(a="dd/mm/yy");var i=R.trim(t.yearRange);""==i&&(i="c-10:c+10"),e.datepicker({changeMonth:!!t.changeMonth&&t.changeMonth,changeYear:!!t.changeYear&&t.changeYear,dateFormat:a,firstDay:!!t.firstDay&&t.firstDay,minDate:t.minDate?t.minDate:"",maxDate:t.maxDate?t.maxDate:"",numberOfMonths:t.numberOfMonths?parseInt(t.numberOfMonths):1,showAnim:t.showAnim?t.showAnim:"fadeIn",showWeek:"1"==t.showWeek&&t.showWeek,yearRange:i,beforeShowDay:function(e){return W.check_datepicker_days(e,r,n)}}),e.on("change keyup",function(e){var t=R(this).datepicker("getDate"),a=W.check_datepicker_days(t,r,n),i=!0;"object"!=typeof a||a[0]||(i=!1),i||R(this).val(""),W.form_change(s,null,null,e)}),W.check_datepicker_predefined_values(e)}),s.find(".ezfc-element-daterange").each(function(){var n=R(this),e=n.closest(".ezfc-element-daterange-container").data("settings"),t=[0,1,2,3,4,5,6];e.available_days.length&&(t=e.available_days.split(",")),t=t.map(function(e){return parseInt(e)});var a=[];e.blocked_days.length&&(a=e.blocked_days.split(","));var s=R.trim(W.form_vars[o].datepicker_format);""==s&&(s="dd/mm/yy");var i=R.trim(e.yearRange);""==i&&(i="c-10:c+10"),n.hasClass("ezfc-element-daterange-from")?n.datepicker({changeMonth:!!e.changeMonth&&e.changeMonth,changeYear:!!e.changeYear&&e.changeYear,dateFormat:s,firstDay:!!e.firstDay&&e.firstDay,minDate:n.data("mindate"),maxDate:n.data("maxdate"),numberOfMonths:e.numberOfMonths?parseInt(e.numberOfMonths):1,showAnim:e.showAnim?e.showAnim:"fadeIn",showWeek:"1"==e.showWeek&&e.showWeek,yearRange:i,onSelect:function(e){var t=n.data("mindays")||0,a=n.data("maxdays")||0,i=R.datepicker.parseDate(s,e);i.setDate(i.getDate()+t);var r=R.datepicker.parseDate(s,e);r.setDate(r.getDate()+a),n.siblings(".ezfc-element-daterange-to").datepicker("option","minDate",i),0!=a&&n.siblings(".ezfc-element-daterange-to").datepicker("option","maxDate",r),n.trigger("change")},beforeShowDay:function(e){return W.check_datepicker_days(e,t,a)}}):n.datepicker({changeMonth:!!e.changeMonth&&e.changeMonth,changeYear:!!e.changeYear&&e.changeYear,dateFormat:s,firstDay:!!e.firstDay&&e.firstDay,minDate:n.data("mindate"),maxDate:n.data("maxdate"),numberOfMonths:e.numberOfMonths?parseInt(e.numberOfMonths):1,showAnim:e.showAnim?e.showAnim:"fadeIn",showWeek:"1"==e.showWeek&&e.showWeek,yearRange:i,onSelect:function(e){n.trigger("change")},beforeShowDay:function(e){return W.check_datepicker_days(e,t,a)}}),W.check_datepicker_predefined_values(n)}),s.find(".ezfc-element-timepicker").each(function(){W.init_timepicker(R(this),o)}),s.find(".ezfc-element-colorpicker").each(function(){var t=R(this),a=t.parents(".ezfc-element").find(".ezfc-element-colorpicker-input"),e=t.colorpicker({container:t}).on("changeColor.colorpicker",function(e){t.css("background-color",e.color.toHex()),a.val(e.color.toHex())});R(a).on("click focus",function(){e.colorpicker("show")}).on("change",function(){e.colorpicker("setValue",s.val())})});var a=s.find(".ezfc-step");if(0<a.length){var i=a.last();s.find(".ezfc-summary-wrapper").appendTo(i),s.find(".ezfc-submit-wrapper").appendTo(i).addClass("ezfc-submit-step"),this.prevent_enter_step_listener(i.find("input"),s)}W.init_form(e)},this.init_slider=function(n){var r=n.data("id"),s=(this.get_element_object(r),n.closest(".ezfc-form").data("id")),e=n.siblings(".ezfc-slider-element"),t=n.hasClass("ezfc-slider-vertical")?"vertical":"horizontal",a=this.normalize_value(n.val(),n),i={min:n.data("min")||0,max:n.data("max")||100,step:n.data("stepsslider")||1,value:a||0,orientation:t},o=n.data("values"),l=null;if(o)for(var c in l=String(o).split(","),l=R.map(l,R.trim),i.min=0,i.max=l.length-1,l)l[c]==a&&(i.value=c);i.change=function(e,t){var a=W.normalize_value(n.val(),n),i=a;if(l)for(var r in l){W.normalize_value(a,n);a==l[r]&&(i=r)}this.value=i},i.slide=function(e,t){var a=t.value;l&&void 0!==l[t.value]&&(a=l[t.value]);var i=W.format_price(s,a,!1,!1,!1,!0);n.val(i),n.trigger("change")},i.start=function(e,t){n.trigger("focus")},i.stop=function(e,t){var a=t.value;l&&void 0!==l[t.value]&&(a=l[t.value]);var i=W.format_value_element(r,a);n.val(i),n.trigger("change"),n.trigger("blur")};e.slider(i);if(n.hasClass("ezfc-pips")){var _={rest:"label"};l&&(_.labels=l),isNaN(n.data("stepspips"))||""==n.data("stepspips")||(_.step=n.data("stepspips")),e.slider("pips",_),e.find(".ui-slider-pip").on("click",function(){var e=R(this).find(".ui-slider-label").data("value");l&&void 0!==l[e]&&(e=l[e]),e=W.format_price(s,e,!1,!1,!1,!0),n.val(e),n.trigger("change"),n.trigger("blur")}),1==n.data("pipsfloat")&&e.slider("float")}},this.init_spinner=function(r){var n=r.closest(".ezfc-custom-element").data("id"),a=r.closest(".ezfc-form").data("id"),e=r.data("stepsspinner")||1;r.spinner({min:r.data("min")||0,max:r.data("max")||100,step:e,change:function(e,t){},spin:function(e,t){W.format_price(a,t.value,!1,!1,!1,!1)},start:function(e,t){var a=r.val(),i=W.normalize_value(a);r.val(i)},stop:function(e,t){var a=r.val();a=W.normalize_value(a,r);var i=W.format_value_element(n,a);r.val(i),r.trigger("change"),r.trigger("blur")}})},this.init_timepicker=function(e,t,a){var i={};e.data("settings")&&(i=e.data("settings")),"object"==typeof a&&(i=R.extend({},i,a));var r=i.format?i.format:W.form_vars[t].timepicker_format;""==r&&(r="H:i"),e.timepicker({disableTimeRanges:i.disabledTimes?i.disabledTimes:[],minTime:i.minTime?i.minTime:null,maxTime:i.maxTime?i.maxTime:null,step:i.steps?i.steps:30,timeFormat:r})},this.init_form_vars=function(){for(var a in ezfc_vars.form_vars)this.form_vars[a]=ezfc_vars.form_vars[a],this.subtotals[a]=[],this.conditional_once[a]=[],this.external_listeners[a]=[],this.elements_cache[a]=[],this.current_steps[a]=0,this.trigger_list[a]=[],R.each(this.form_vars[a].form_elements_order,function(e,t){W.form_vars[a].form_elements_order[e]=String(W.form_vars[a].form_elements_order[e]),W.add_form_element_to_cache(t,a)})},this.add_form_element_to_cache=function(e,t){if(void 0!==ezfc_vars.element_vars[t][e]){var a=R("#ezfc_element-"+e),i={element:ezfc_vars.element_vars[t][e],$element:a,$element_input:a.find("input, textarea"),id:e,form_id:t};this.$form_elements[e]=i}},this.init_form=function(e){var t=R(e),a=t.data("id");if(this.set_ref_id(a),1==this.form_vars[a].price_show_request&&this.price_request_toggle(a,!1),this.price_old_global[a]=0,this.set_price(t),this.set_submit_text(t),this.form_vars[a].use_woocommerce){R(".woocommerce form.cart, .woocommerce .price").hide()}var i=parseInt(this.form_vars[a].step_indicator_start)+1;for(var r in 1<i&&t.find(".ezfc-step-indicator").hide(),2!=ezfc_vars.debug_mode||R("#ezfc-show-all-elements").length||(t.append("<button id='ezfc-show-all-elements'>Show/hide elements</button>"),R("#ezfc-show-all-elements").click(function(){return t.hasClass("ezfc-debug-visible")?(t.removeClass("ezfc-debug-visible"),t.find(".ezfc-tmp-visible").removeClass("ezfc-tmp-visible").hide()):(t.addClass("ezfc-debug-visible"),t.find(".ezfc-hidden").addClass("ezfc-tmp-visible").show().css("display","inline-block")),!1})),1==this.form_vars[a].use_stripe&&"undefined"!=typeof Stripe&&Stripe.setPublishableKey(ezfc_vars.stripe.publishable_key),this.prevent_enter_step_listener(":input:not(textarea):not([type=submit])",t),this.populate_html_placeholders(t),1==this.form_vars[a].popup_open_auto&&this.popup_form_open(a),this.init_table_order(a),ezfc_vars.element_vars[a]){var n=ezfc_vars.element_vars[a][r];if("repeatable_form"==n.type&&(this.init_repeatable_group(n.id),1==n.repeatable)){var s=parseInt(this.get_element_object_value(n,"repeatable_count_start",0));s=Math.min(s,this.get_element_object_value(n,"repeatable_count_max"));for(var o=0;o<s;o++)this.group_repeat(n.id)}}R(document).trigger("ezfc_form_init",a)},this.form_change=function(e,t,a,i){if(e=e||R("#ezfc-form-"+t),t=t||R(e).data("id"),e&&e.length||(e=a.closest(".ezfc-form")).length){if(this.trigger_list[t]=[],this.$element_trigger=a,this.element_trigger_id=0,a&&(this.element_trigger_id=a.data("id"),a.hasClass("ezfc-custom-element")||(this.element_trigger_id=a.closest(".ezfc-custom-element").data("id")),!this.element_trigger_id||!this.element_trigger_id.indexOf||this.element_trigger_id.indexOf("-")<0)){var r=this.get_element_object(this.element_trigger_id);if(!r.hasOwnProperty("trigger_ids")||r.trigger_ids.length<1)return;this.form_build_trigger_list(t,r.id)}this.clear_hidden_values(e),this.form_vars[t].price_requested=0,this.form_vars[t].summary_shown=0,R(e).find(".ezfc-summary-wrapper").fadeOut(),1==this.form_vars[t].price_show_request&&this.price_request_toggle(t,!1),this.remove_debug_info(),this.set_price(e),this.set_submit_text(e),this.populate_html_placeholders(e),this.live_summary_update(t),this.scroll(),this.call_hook("ezfc_after_form_change",{form_id:t})}},this.form_build_trigger_list=function(e,t){var a=this.get_element_object(t),i=[t];R.each(a.trigger_ids,function(e,t){var a=W.get_element_object(t);i=i.concat(a.trigger_ids)}),this.trigger_list[e]=this.unique(i)},this.form_submit=function(p,h,e,t){var v=R(p),g=v.closest(".ezfc-wrapper"),b=v.data("id");this.call_hook("ezfc_form_submit_start",{data:k,form:v,form_vars:this.form_vars[b],id:b});var r=!1;v.find(".ezfc-submit-icon").addClass("ezfc-submit-icon-show");var z=v.find(".ezfc-submit-icon, .ezfc-step-submit-icon"),y=v.find("input[type='submit']");if(1==this.form_vars[b].price_show_request&&this.set_price(p),t)return W.submit_cancel(v),!1;if(-1!==R.inArray(e,W.payment_methods)){var a=R("#ezfc-"+e+"-form-"+b),i=this.format_price(b,this.price_old_global[b],!1,!1,!0);if(a.find(".ezfc-payment-price").text(i),W.form_vars[b].payment_info_shown[e]){if(W.payment_form_id=b,a.find(".ezfc-payment-submit, .ezfc-payment-cancel").prop("disabled",!0),"stripe"==e)Stripe.card.createToken(a,this.stripe_response_handler);else if("authorize"==e){if("undefined"==typeof Accept)return W.debug_message("AcceptJS wasn't loaded."),!1;this.authorize_create_token(b)}}else W.form_vars[b].payment_info_shown[e]=1,R("#ezfc-"+e+"-form-"+b+", #ezfc-"+e+"-form-modal-"+b).addClass("ezfc-payment-dialog-open");return z.fadeOut(),!1}z.fadeIn(),y.prop("disabled",!0),v.find(".ezfc-custom-hidden:not(.ezfc-element-wrapper-fileupload):not(.ezfc-element-wrapper-group)").each(function(){var e=R(this).find(".ezfc-element-radio:not(:has(:radio:checked))");e.length&&R(e).first().find("input").prop("checked",!0),R(this).find("option").first().prop("checked",!0).val(u),R(this).find(".ezfc-element-checkbox-input").first().prop("checked",!0).addClass("ezfc-has-hidden-placeholder").val(u),R(this).find(":input").val(u).removeAttr("disabled").addClass("ezfc-has-hidden-placeholder")});var n="";for(var s in this.form_vars[b].form_elements_order){var o=this.form_vars[b].form_elements_order[s],l=this.get_element_object(o);if(!l||"repeatable_form"!=l.type)if(this.is_repeatable_element(o)){var c=this.get_repeatable_parent_id(o);if(!c)continue;n+="&calculated_values["+c+"]["+this.get_repeatable_element_id(o)+"]["+this.get_repeatable_element_counter(o)+"]="+this.get_calculated_element_value(b,o)}else{var _=this.get_element_object_value(o,"calculate_enabled",1),d=W.element_is_visible(o);if(d&&(n+="&elements_visible["+o+"]=1"),0==_&&!d)this.get_element_child_input_dom(o).val(u);n+="&calculated_values["+o+"]="+this.get_calculated_element_value(b,o)}}v.find(".ezfc-element-wrapper-checkbox").each(function(){if(R(this).find(".ezfc-has-hidden-placeholder").length)return!1;var e=R(this),t=parseInt(e.attr("data-min_selectable")),a=parseInt(e.attr("data-max_selectable")),i=e.find(":checked").length;0<t&&i<t&&(r=!0,W.show_tip(e,"#"+e.attr("id"),0,W.sprintf(W.form_vars[b].selectable_min_error,t)),W.scroll_to(e)),0<a&&a<i&&(r=!0,W.show_tip(e,"#"+e.attr("id"),0,W.sprintf(W.form_vars[b].selectable_max_error,a)),W.scroll_to(e))});var k=v.serialize();if(k+=n,R.each([],function(e,t){R(t.element).val(t.value)}),r)return z.fadeOut(),y.removeAttr("disabled"),W.clear_hidden_values(v),!1;R(".ezfc-element[data-min], .ezfc-element[data-max]").each(function(){var e=R(this).closest(".ezfc-custom-element").data("id"),t=R(this).data("min"),a=R(this).data("max"),i="&dynamic_min["+e+"]="+t;k+=i+="&dynamic_max["+e+"]="+a}),k+="&url="+encodeURI(window.location.href),0==this.form_vars[b].price_requested&&(k+="&price_requested=1"),0==this.form_vars[b].summary_shown&&(k+="&summary=1"),-1!=h&&(k+="&step="+h),this.form_vars[b].preview_form&&(k+="&preview_form="+this.form_vars[b].preview_form);var f=this.price_old_global[b];1==this.form_vars[b].price_show_request&&(f=W.functions.calculate_price(b)),k+="&generated_price="+f,this.call_hook("ezfc_before_submission",{data:k,form:v,form_vars:this.form_vars[b],id:b}),R.ajax({type:"post",url:ezfc_vars.ajaxurl,data:{action:"ezfc_frontend",data:k},success:function(t){R(".ezfc-submit-icon").removeClass("ezfc-submit-icon-show"),y.removeAttr("disabled"),z.fadeOut(),W.debug_message(t);try{t=R.parseJSON(t)}catch(e){t=!1,W.debug_message(e)}if(!t)return R("#ezfc-message-"+b).text(ezfc_vars.form_submit_error),W.recaptcha_reload(),W.reset_disabled_fields(p,!0),!1;if(void 0!==t.error){if(W.reset_disabled_fields(p,!0),t.id){var e=!0,a="#ezfc_element-"+t.id,i=R(a).find(".ezfc-element").first(),r=0<v.find(".ezfc-step-active").length;if(r)parseInt(R(a).parents(".ezfc-step").data("step"))!=h&&-1!=h&&(e=!1,W.set_step(p,h+1));if(e){i.length||(i=R(a));var n=r?1e3:400,s=0<g.find(".ezfc-payment-dialog-open").length;if(i.is(":visible"))W.show_tip(i,a,n,t.error),s&&W.set_message(b,t.error+" (#"+t.id+")");else{var o=i.parents(".ezfc-element-wrapper-group");o.length?(o.each(function(e,t){W.toggle_group(R(t),!0)}),W.show_tip(i,a,n,t.error)):W.set_message(b,t.error+" (#"+t.id+")")}if(void 0!==ezfc_vars.required_text_auto_hide){var l=1e3*parseFloat(ezfc_vars.required_text_auto_hide);0<l&&setTimeout(function(){null},l)}0==W.form_vars[b].disable_error_scroll&&W.scroll_to(a)}}else W.set_message(b,t.error);return W.recaptcha_reload(),!1}if(t.step_valid)return W.reset_disabled_fields(p),W.set_step(p,h+1),!1;if(t.summary)return v.find(".ezfc-summary-wrapper").fadeIn().find(".ezfc-summary").html(t.summary),W.form_vars[b].summary_shown=1,W.reset_disabled_fields(p),!1;if(W.recaptcha_reload(),t.paypal)y.attr("disabled","disabled"),window.location.href=t.paypal;else{if(t.price_requested||0===t.price_requested)return W.price_request_toggle(b,!0,t.price_requested),!1;var c={data:k,form:v,form_vars:W.form_vars[b],id:b,price:price,response:t};W.call_hook("ezfc_submission_success",c),W.form_vars[b].submission_js_func&&"function"==typeof window[W.form_vars[b].submission_js_func]&&window[W.form_vars[b].submission_js_func](c),g.find(".ezfc-payment-dialog, .ezfc-payment-dialog-modal").removeClass("ezfc-payment-dialog-open");var _=R(".ezfc-success-text[data-id='"+b+"']");if(_.html(t.success),W.set_ref_id(b),1==W.form_vars[b].reset_after_submission){W.reset_form(p);var d=1e4;return W.object_has_property(W.form_vars[b],"show_success_text_duration")&&(d=1e3*parseFloat(W.form_vars[b].show_success_text_duration)),0==d&&(d=99999999999),void _.fadeIn().delay(d).fadeOut()}1==W.form_vars[b].hide_all_forms?R(".ezfc-form, .ezfc-required-notification").fadeOut().addClass("ezfc-form-submitted"):(v.find(".ezfc-required-notification").fadeOut(),1==W.form_vars[b].show_success_text&&v.fadeOut().addClass("ezfc-form-submitted")),1==W.form_vars[b].show_success_text&&(1==W.form_vars[b].scroll_to_success_message?_.fadeIn(400,function(){W.scroll_to(_)}):_.fadeIn()),t.woo_update_cart&&(R(document.body).trigger("wc_fragment_refresh"),W.call_hook("ezfc_wc_submission_success",c));var f=Math.max(0,Math.abs(parseInt(W.form_vars[b].redirect_timer)));if(void 0!==W.form_vars[b].redirect_url&&0<W.form_vars[b].redirect_url.length){var u="";1==W.form_vars[b].redirect_forward_values&&(u=v.serialize(),u+="&total="+W.price_old_global[b],u+="&total_f="+W.functions.price_format(b,W.price_old_global[b])),t.hasOwnProperty("insert_key")&&(u+="&ezfc_insert_key="+t.insert_key);var m=-1==W.form_vars[b].redirect_url.indexOf("?")?"?":"&";setTimeout(function(){window.location.href=W.form_vars[b].redirect_url+m+u},1e3*f)}else void 0!==W.form_vars[b].refresh_page_after_submission&&1==W.form_vars[b].refresh_page_after_submission&&setTimeout(function(){window.location.reload()},1e3*f)}}}).fail(function(e,t,a){return W.debug_message({jqXHR:e,testStatus:t,errorThrown:a}),W.set_message(b,ezfc_vars.form_submit_error),W.submit_cancel(v),!1})},this.calculate_get_external_values=function(e,t,a,i){if(a){var r,n=a.data("value_external"),s=a.data("value_external_listen");if(!this.external_listeners[t][n]||s)if(n&&0<R(n).length)r=R(n).is("input[type='radio']")?R(n).find(":checked").val():R(n).is("input, input[type='text'], textarea")?R(n).val():R(n).is("select")?R(n).find(":selected").text():R(n).text(),"input"==i||"numbers"==i||"subtotal"==i?a.find("input").val(r):"dropdown"==i?(a.find(":selected").removeAttr("selected"),a.find("option[value='"+r+"']").attr("selected","selected")):"radio"==i?(a.find(":checked").removeAttr("checked"),a.find("input[value='"+r+"']").attr("checked","checked")):"checkbox"==i?(a.find(":checked").removeAttr("checked"),a.find("input[value='"+r+"']").attr("checked","checked")):"textfield"==i&&a.find("textarea").val(r),this.external_listeners[t][n]||(this.external_listeners[t][n]=1,R(n).on("change keyup",function(){W.set_price(R(e))}))}},this.calculate_conditionals=function(e,m,p,h,t){var v=this.get_element_object(p),g=this.get_element_dom(p);if(p&&v.hasOwnProperty("conditional")||t){var b=v.conditional;if(t&&(b=p),b){var z=this.get_value_from_element(g,null,0==v.is_number),a=this.get_element_object_value(v,"factor",1);for(var y in b.action){var i=b.action[y];if(i&&0!=i){var k,r=b.target[y],n=W.get_element_object(r);if((k="submit_button"==b.target[y]||"redirect"==i?R(e).find(".ezfc-submit"):"price"==b.target[y]?R(e).find(".ezfc-price-wrapper-element"):W.get_element_dom(r))&&!(k.length<1&&b.redirects.length<1)){1==b.use_factor[y]&&(a=parseFloat(a),isNaN(a)||(z*=a));var s=[{operator:b.operator[y],value:b.values[y],compare_target:W.get_object_value(b,"compare_value_first","",y)}];void 0!==b.chain&&void 0!==b.chain[y]&&(b.chain[y].operator,1)&&R.each(b.chain[y].operator,function(e,t){s.push({operator:b.chain[y].operator[e],value:b.chain[y].value[e],compare_target:b.chain[y].compare_target[e]})});var w=!1,x=0,j=0;R.each(s,function(e,t){if(""!=t.operator){j++;var a=!1,i=t.value,r=[],n=z,s=v;if(0!=t.compare_target&&""!=t.compare_target&&(n=W.get_value_from_element(!1,t.compare_target),s=W.get_element_object(t.compare_target)),"__self__"==t.value&&(t.value=z),i=1==v.is_number&&-1===R.inArray(t.operator,Y)&&"datepicker"!==s.type?parseFloat(t.value):t.value,"between"!=t.operator&&"not_between"!=t.operator||1<(r=t.value.split(":")).length&&"datepicker"!==s.type&&(r[0]=parseFloat(r[0]),r[1]=parseFloat(r[1])),"datepicker"===s.type){var o=W.get_element_child_input_dom(s.id);if(!o)return;var l=R(o).datepicker("getDate");if(W.is_valid_date(l)&&(l.setHours(0,0,0,0),n=l.getTime()),1<r.length)r=[new Date(r[0]),new Date(r[1])],W.is_valid_date(r[0])&&r[0].setHours(0,0,0,0),W.is_valid_date(r[1])&&r[1].setHours(0,0,0,0);else{var c=new Date(i);c.setHours(0,0,0,0),i=c.getTime()}}switch(t.operator){case"gr":a=i<n;break;case"gre":a=i<=n;break;case"less":a=n<i;break;case"lesse":a=n<=i;break;case"equals":a="input"==h?i.toLowerCase()==k.val().toLowerCase():n==i;break;case"between":a=!(r.length<2)&&(n>=r[0]&&n<=r[1]);break;case"not_between":a=!(r.length<2)&&(n<r[0]||n>r[1]);break;case"not":a=r.length<2?n!=i:n<r[0]&&n>r[1];break;case"hidden":a=!W.element_is_visible(p);break;case"visible":a=W.element_is_visible(p);break;case"mod0":a=0<n&&n%i==0;break;case"mod1":a=0<n&&n%i!=0;break;case"bit_and":a=n&i;break;case"bit_or":a=n|i;break;case"empty":void 0===n&&(a=!0),a="number"==typeof n?isNaN(n):n.length<1;break;case"notempty":a=void 0!==n&&("number"==typeof n?!isNaN(n):0<n.length);break;case"contains":case"starts_with":case"ends_with":if(void 0===n)a=!1;else{var _=R.trim(String(i)),d=R.trim(String(n));"contains"==t.operator?a=d.includes(_):"starts_with"==t.operator?a=d.startsWith(_):"ends_with"==t.operator&&(a=d.endsWith(_))}break;case"in":a=void 0!==n&&W.conditional_check_multiple_options(i,n);break;case"not_in":a=void 0!==n&&!W.conditional_check_multiple_options(i,n);break;case"once":a=!0,void 0===W.conditional_once[m][p]&&(W.conditional_once[m][p]=[]),void 0===W.conditional_once[m][p][y]&&(W.conditional_once[m][p][y]=[]),void 0===W.conditional_once[m][p][y][e]?W.conditional_once[m][p][y][e]=1:a=!1;break;case"selected":case"selected_index":case"selected_id":case"selected_count":case"selected_count_gt":case"selected_count_lt":a=!1;var f="value";"selected_index"==t.operator?f="index":"selected_id"==t.operator?f="option_id":"selected_count"!=t.operator&&"selected_count_gt"!=t.operator&&"selected_count_lt"!=t.operator||(f="count"),a="object"==typeof(u=0!=t.compare_target&&""!=t.compare_target?W.get_value_from_element(!1,t.compare_target,!0,!1,{return_array:!0,return_value:f}):W.get_value_from_element(g,null,!0,!1,{return_array:!0,return_value:f}))?W.conditional_check_multiple_options(i,u):"selected_count"==t.operator?u==i:"selected_count_gt"==t.operator?i<u:"selected_count_lt"==t.operator?u<i:W.conditional_check_multiple_options(i,u);break;case"not_selected":case"not_selected_index":case"not_selected_id":case"not_selected_count":a=!0;var u;f="value";"not_selected_index"==t.operator?f="index":"not_selected_id"==t.operator?f="option_id":"not_selected_count"==t.operator&&(f="count"),u=0!=t.compare_target&&""!=t.compare_target?W.get_value_from_element(!1,t.compare_target,!0,!1,{return_array:!0,return_value:f}):W.get_value_from_element(g,null,!0,!1,{return_array:!0,return_value:f}),a=!W.conditional_check_multiple_options(i,u);break;case"focus":a=0<g.find(".ezfc-slider").length?g.find("input").is(":focus")||0<g.find(".ui-state-active").length:g.find("input").is(":focus");break;case"blur":a=0<g.find(".ezfc-slider").length?!g.find("input").is(":focus")&&g.find(".ui-state-active").length<1:!g.find("input").is(":focus");break;case"always":a=!0;break;case"step_equals":a=W.current_steps[m]==i;break;case"step_gt":a=i<W.current_steps[m];break;case"step_lt":a=W.current_steps[m]<i;break;case"calculate_enabled":a=1==W.get_element_object_value(v,"calculate_enabled",1);break;case"calculate_disabled":a=0==W.get_element_object_value(v,"calculate_enabled",1);break;case"triggered":a=!!s&&W.element_trigger_id==s.id;break;default:a=!1}if(void 0!==b.row_operator[y]&&1==b.row_operator[y]){if(a)return x++,!(w=!0)}else{if(!a)return;x++}}}),0<x&&x==j&&(w=!0);var o=b.notoggle[y],l=k.data("element"),c=b.target_value[y];if(c=c.replace(/__self__/gi,z),"group"==l&&k.push(R(k).find("> .ezfc-custom-element")),"set"!=i&&"add_text"!=i||!w)if("set_factor"==i&&w)W.set_element_object_value(r,"factor",c);else if("select_option"==i&&w){var _=c.split("|");for(var d in _){var f=_[d];"radio"==l?W.radio_change_state(k.find("input[data-optionid='"+f+"']"),!0,!0):"checkbox"==l?W.checkbox_change_state(k.find("input[data-optionid='"+f+"']"),!0,!0):"dropdown"==l&&(k.find(":selected").removeAttr("selected"),k.find("option[data-optionid='"+f+"']").prop("selected","selected"))}}else if("deselect_option"!=i&&"deselect_all_options"!=i||!w)if("show_option"==i){_=c.split("|");for(var d in _){f=_[d];w?"radio"==l||"checkbox"==l?k.find("input[data-optionid='"+f+"']").closest(".ezfc-element-single-option-container").show():"dropdown"==l&&k.find("option[data-optionid='"+f+"']").removeAttr("hidden"):"radio"==l?(W.radio_change_state(k.find("input[data-optionid='"+f+"']"),!1,!0),k.find("input[data-optionid='"+f+"']").closest(".ezfc-element-single-option-container").hide()):"checkbox"==l?(W.checkbox_change_state(k.find("input[data-optionid='"+f+"']"),!1,!0),k.find("input[data-optionid='"+f+"']").closest(".ezfc-element-single-option-container").hide()):"dropdown"==l&&(k.find(":selected").removeAttr("selected"),k.find("option[data-optionid='"+f+"']").attr("hidden",!0))}}else if("hide_option"==i){_=c.split("|");for(var d in _){f=_[d];w?"radio"==l?(W.radio_change_state(k.find("input[data-optionid='"+f+"']"),!1,!0),k.find("input[data-optionid='"+f+"']").closest(".ezfc-element-single-option-container").hide()):"checkbox"==l?(W.checkbox_change_state(k.find("input[data-optionid='"+f+"']"),!1,!0),k.find("input[data-optionid='"+f+"']").closest(".ezfc-element-single-option-container").hide()):"dropdown"==l&&k.find("option[data-optionid='"+f+"']").attr("hidden",!0).removeAttr("selected"):"radio"==l||"checkbox"==l?k.find("input[data-optionid='"+f+"']").closest(".ezfc-element-single-option-container").show():"dropdown"==l&&k.find("option[data-optionid='"+f+"']").removeAttr("hidden")}}else if("activate"==i){if(w)if("submit"==l)k.prop("disabled",!1);else if("group"==l){var u=W.get_group_children(r);W.set_element_list_object_value(u,"calculate_enabled",1)}else W.set_element_object_value(r,"calculate_enabled",1);else if(1!=o)if("submit"==l)k.prop("disabled",!0);else if("group"==l){u=W.get_group_children(r);W.set_element_list_object_value(u,"calculate_enabled",0)}else W.set_element_object_value(r,"calculate_enabled",0)}else if("activate_option"==i){var C="[data-optionid='"+b.option_index_value[y]+"']";w?k.find(C).prop("disabled",!1).removeClass("force-disabled"):k.find(C).prop("disabled",!0).addClass("force-disabled")}else if("deactivate"==i){if(w)if("submit"==l)k.prop("disabled",!0);else if("group"==l){u=W.get_group_children(r);W.set_element_list_object_value(u,"calculate_enabled",0)}else W.set_element_object_value(r,"calculate_enabled",0);else if(1!=o)if("submit"==l)k.prop("disabled",!1);else if("group"==l){u=W.get_group_children(r);W.set_element_list_object_value(u,"calculate_enabled",1)}else W.set_element_object_value(r,"calculate_enabled",1)}else if("deactivate_option"==i){var D="[data-optionid='"+b.option_index_value[y]+"']";w?k.find(D).prop("disabled",!0).addClass("force-disabled"):k.find(D).prop("disabled",!1).removeClass("force-disabled")}else if("redirect"==i&&w){R(e).parents(".ezfc-wrapper").find(".ezfc-message").text(W.form_vars[m].redirect_text).fadeIn(),R(e).fadeOut(),setTimeout(function(){window.location.href=b.redirects[y]},1e3*W.form_vars[m].redirect_timer)}else if("step_goto"!=i&&"step_prev"!=i&&"step_next"!=i||!w)if("set_min"!=i&&"set_max"!=i||!w)if("set_min_selectable"==i&&w)k.attr("data-min_selectable",c),W.checkbox_change(k);else if("set_max_selectable"==i&&w)k.attr("data-max_selectable",c),W.checkbox_change(k);else if("add_class"==i){k[w?"addClass":"removeClass"](c)}else if("remove_class"==i){k[w?"removeClass":"addClass"](c)}else if("set_color"==i&&w)k.find("input, select, .ezfc-price, .ezfc-element-checkbox-text").css("color",c),"submit"==l&&k.css("color",c);else if("calc_routine_enable"==i){var N=parseInt(c);isNaN(N)||(N-=1,n.hasOwnProperty("calculate_routine")&&"object"==typeof n.calculate_routine[N]&&(n.calculate_routine[N].activated=w))}else if("calc_routine_enable_name"==i){if(0<c.length&&n.hasOwnProperty("calculate_routine")){var O=W.get_calculation_routine_by_name(n,c);for(var F in O)"object"==typeof n.calculate_routine[O[F]]&&(n.calculate_routine[O[F]].activated=w)}}else if("calc_routine_disable"==i){N=parseInt(c);isNaN(N)||(N-=1,n.hasOwnProperty("calculate_routine")&&"object"==typeof n.calculate_routine[N]&&(n.calculate_routine[N].activated=!w))}else if("calc_routine_disable_name"==i){if(0<c.length&&n.hasOwnProperty("calculate_routine")){O=W.get_calculation_routine_by_name(n,c);for(var F in O)"object"==typeof n.calculate_routine[O[F]]&&(n.calculate_routine[O[F]].activated=!w)}}else W.call_conditional_action(w,i,k,r,o,c);else{var I="set_min"==i?"min":"max",q=k.find(":input"),A=parseFloat(c),T=q.data("min"),M=q.data("max");if("set_min"==i&&M<A)continue;if("set_max"==i&&A<T)continue;if(q.data(I,A).trigger("ezfc_blur_trigger"),q.hasClass("ezfc-slider")){var S=k.find(".ezfc-slider-element");void 0!==S.slider&&void 0!==S.slider("instance")&&S.slider("option",I,A)}}else W.set_step_action(m,i,b.target[y]);else{var _=c.split("|");for(var d in _){var $="input[data-optionid='"+(f=_[d])+"']";"deselect_all_options"==i&&($=":selected, :checked"),"radio"==l?W.radio_change_state(k.find($),!1,!0):"checkbox"==l?W.checkbox_change_state(k.find($),!1,!0):"dropdown"==l&&k.find(":selected").removeAttr("selected")}}else{var P=W.check_inline_math(c,k);if("add_text"==i)P=k.find("input").val()+c;if("input"==l||"hidden"==l||"numbers"==l||"subtotal"==l||"set"==l)W.set_element_object_value(r,"current_value",P),W.set_element_object_value(r,"current_value_forced",P),k.find("input").val(P).trigger("blur");else if("dropdown"==l)k.find(":selected").removeAttr("selected"),k.find("option[data-value='"+P+"']").prop("selected","selected");else if("radio"==l)W.radio_change_state(k.find("input[data-value='"+P+"']"),!0,!0);else if("checkbox"==l)W.checkbox_change_state(k.find("input[data-value='"+P+"']"),!0,!0);else if("datepicker"==l){(E=k.find("input.hasDatepicker")).length&&E.datepicker("setDate",c)}else if("daterange"==l){var E;if(1<(E=k.find("input.hasDatepicker")).length){var H=c.split(";;");void 0!==H[0]&&R(E[0]).datepicker("setDate",H[0]),void 0!==H[1]&&R(E[1]).datepicker("setDate",H[1])}}else"image"==l?k.find("img").attr("src",c):k.text(P)}}}}}}},this.conditional_actions={class_hidden:"ezfc-hidden ezfc-custom-hidden",class_visible:"ezfc-fade-in",show:function(e,t,a,i){t.addClass(W.conditional_actions.class_visible).removeClass(W.conditional_actions.class_hidden),a&&"group"==a.type&&t.find(".ezfc-element").addClass(W.conditional_actions.class_visible).removeClass(W.conditional_actions.class_hidden),e||1==i||W.conditional_actions.hide(!0,t,a)},hide:function(e,t,a,i){t.addClass(W.conditional_actions.class_hidden).removeClass(W.conditional_actions.class_visible),a&&"group"==a.type&&t.find(".ezfc-element").addClass(W.conditional_actions.class_hidden).removeClass(W.conditional_actions.class_visible),e||1==i||W.conditional_actions.show(!0,t,a)}},this.call_conditional_action=function(e,t,a,i,r,n){if(this.conditional_actions.hasOwnProperty(t)){var s;if("submit_button"==i)s=null;else if(!(s=this.get_element_object(i)))return;this.conditional_actions[t](e,a,s,r,n)}},this.calculate_element=function(p,h,v){!p&&h&&(p=R("#ezfc_element-"+h).closest(".ezfc-form").data("id"));var g=this.get_element_dom(h),b=this.get_element_object(h),e=this.get_repeatable_parent_id(h);if(void 0!==b)if(g){e&&(p=this.get_element_object_value(e,"form_id",0));var z=void 0===b.calculate?[]:b.calculate,y=b.calculate_enabled,k=b.add_to_price,w=b.type,x=(W.form_vars[p].has_steps,b.overwrite_price),j=0,C=W.get_value_from_element(g,null,!1);if("subtotal"!=w&&"custom_calculation"!=w&&"extension"!=w||(j=v),"extension"==w&&(z=[]),0!=this.get_element_object_value(b,"calculate_when_zero",1)||0!=j){var t=g.find(".ezfc-element-numbers, .ezfc-element-input-hidden, .ezfc-element-subtotal, .ezfc-element-daterange-container, .ezfc-element-set, .ezfc-element-extension, :selected, :checked, .ezfc-element-custom-calculation, .ezfc-element-table_order"),D=["ceil","floor","round","abs","subtotal"];if(R(t).each(function(e,_){if(void 0!==z&&0!=z.length||"custom_calculation"==w||"repeatable_form"==w)if(W.element_is_visible(h)||0!=b.calculate_when_hidden||"hidden"==w||"custom_calculation"==w)if(y&&0!=y||z.targets||z.values||"set"==w||"subtotal"==w||"hidden"==w||"extension"==w||"custom_calculation"==w||"repeatable_form"==w)if(y&&0!=y||"custom_calculation"==w){var t=parseFloat(W.get_element_object_value(b,"factor",1));R(_).val();C&&!isNaN(C)||(C=0),t&&!isNaN(t)||0===t||(t=1);var d=C;switch(w){case"numbers":case"extension":case"hidden":d=C;break;case"dropdown":case"radio":case"checkbox":d=parseFloat(R(_).data("value")),isNaN(d)&&(d=0);break;case"subtotal":d=v;break;case"daterange":var a=[R(_).find(".ezfc-element-daterange-from").datepicker("getDate"),R(_).find(".ezfc-element-daterange-to").datepicker("getDate")];d=W.jqueryui_date_diff(a[0],a[1],1==W.get_element_object_value(b,"workdays_only",0),b)*t;break;case"custom_calculation":var i=R(g).find(".ezfc-element-custom-calculation").data("function");try{d=window[i](j)}catch(e){W.add_debug_info("custom_calculation",g,"--- Custom Calculation Error ---\n"+e),d=0}if(y&&(d=parseFloat(d)),R(g).find(".ezfc-element-custom-calculation-input").val(d),2==ezfc_vars.debug_mode){var r=R(g).find(".ezfc-element-custom-calculation script").text();W.add_debug_info("custom_calculation",g,"custom_calculation:\n"+r)}break;case"table_order":var f=0,u=W.get_element_object(h),m=W.get_element_object_value(u,"table_order_loop_function","");R.each(u.table_order,function(e,t){var a,i=g.find(".ezfc-element-table_order-row[data-row='"+e+"'] .ezfc-element-table_order-quantity-input"),r=W.normalize_value(i.val()),n="",s=parseFloat(t.value)*r;"function"==typeof window[m]&&(a=window[m](s,r,e,p,h,u));var o=s;"object"==typeof a&&(s=W.get_element_object_value(a,"value",s),n=W.get_element_object_value(a,"text",""));var l=s;o!=s&&(l=o);var c=W.format_price(p,l,null,null,u.is_currency);c+=n,f+=s,g.find(".ezfc-element-table_order-row[data-row='"+e+"'] .ezfc-element-table_order-subtotal").html(c)}),d=f}!1;var n=[];if(void 0!==z[0]&&(n=z.slice(0)),b.hasOwnProperty("calculate_routine"))for(var s in b.calculate_routine)if(b.calculate_routine[s].activated&&void 0!==z[0])for(var o in b.calculate_routine[s].calculation_rows)n.push(b.calculate_routine[s].calculation_rows[o]);if(void 0!==n[0]){for(var l in z)if("__open__"==z[l].target&&void 0===z[l].reference_index)for(var c in z[l].prio=parseInt(z[l].prio),isNaN(z[l].prio)&&(z[l].prio=0),z)l!=c&&(z[c].prio=parseInt(z[c].prio),isNaN(z[c].prio)&&(z[c].prio=0),"__close__"==z[c].target&&z[l].prio==z[c].prio&&void 0===z[l].reference_index&&void 0===z[c].reference_index&&(z[c].operator=z[l].operator,z[c].reference_index=l,z[l].reference_index=c));R.each(n,function(e,t){if(t.operator&&0!=t.operator||"__close__"==t.target){if("__open__"==t.target)return t.value=d,void(d=0);var a=[],i=[];if(-1===R.inArray(t.operator,D)&&"__open__"!=t.target&&"__close__"!=t.target&&(a=W.get_element_dom(t.target),i=W.get_element_object(t.target),!W.element_is_visible(t.target)&&0==i.calculate_when_hidden))return W.add_debug_info("calculate",g,"#"+e+": Skipping this element as it is conditionally hidden."),void(0==e&&"equals"==t.operator&&(d=0));var r,n=t.value,s=0;if("__close__"==t.target){if(void 0===z[t.reference_index])return;r=d,d=z[t.reference_index].value}else 0<a.length?(s=i.id,void 0===t.use_calculated_target_value&&(t.use_calculated_target_value=0),0==t.use_calculated_target_value?r=W.get_value_from_element(null,s,!1):1==t.use_calculated_target_value?r=W.get_target_subtotal_value(p,s)+W.get_calculated_element_value(p,s):2==t.use_calculated_target_value?r=W.get_calculated_element_value(p,s):3==t.use_calculated_target_value?r=W.get_value_from_element(a,null,!1,!0):4==t.use_calculated_target_value&&(r=W.get_value_from_element(a,null,!0,!1,{return_array:!1,return_value:"count"}))):0!=n&&(r=parseFloat(n));switch(r&&!isNaN(r)||(r=0),""!=b.precision&&(r=parseFloat(W.roundTo(r,b.precision))),t.operator){case"add":d+=r;break;case"subtract":d-=r;break;case"multiply":d*=r;break;case"divide":0==r?(W.add_debug_info("calculate",g,"#"+e+": Division by 0."),d=0):(d/=r,"1"==R(_).data("calculate_before")&&(x=1,d=r/C));break;case"equals":d=r;break;case"power":d=Math.pow(d,r);break;case"ceil":d=Math.ceil(d);break;case"floor":d=Math.floor(d);break;case"min":d=Math.min(d,r);break;case"max":d=Math.max(d,r);break;case"minmax":var o=String(n).split(":");if(o.length<2)return;d=Math.max(Math.min(d,o[1]),o[0]);break;case"round":d=Math.round(d);break;case"roundx":d=W.roundTo(d,r);break;case"abs":d=Math.abs(d);break;case"subtotal":d=v;break;case"log":if(0==r)return;d=Math.log(r);break;case"log2":if(0==r)return;d=Math.log2(r);break;case"log10":if(0==r)return;d=Math.log10(r);break;case"sqrt":d=Math.sqrt(d);break;case"function":var l=W.get_element_object_value(t,"data","");if(l.length&&"function"==typeof window[l]){var c=parseFloat(window[l](d,r));isNaN(c)||(d=c)}}W.add_debug_info("calculate",g,"#"+e+": operator = "+t.operator+"\ntarget_value = "+r+"\ntarget_element = #"+s+"\ncalc_value = "+n+"\naddPrice = "+d)}else W.add_debug_info("calculate",g,"#"+e+": No operator found here.")})}1==k?j+=d:2==k&&(j=d),1==x&&(j=d),W.add_debug_info("calculate",g,"===\nprice = "+j+"\naddPrice = "+d+"\nloop_price = "+v+"\nvalue = "+C+"\nfactor = "+t)}else W.add_debug_info("calculate",g,"Calculation is disabled.");else W.add_debug_info("calculate",g,"No target or values were found to calculate with. Subtotal, Hidden and Set elements are skipped.");else W.add_debug_info("calculate",g,"Skipped as element is hidden and calculate_when_hidden is not enabled.")}),void 0!==b.inline_calculation&&"function"==typeof window[b.inline_calculation])try{j=window[b.inline_calculation](j),W.add_debug_info("calculate",g,"===\ninline calculation = "+j)}catch(e){W.add_debug_info("calculate",g,"===\nInvalid inline calculation!")}1==this.get_element_object_value(b,"force_use_value_enabled",0)&&(j=this.get_element_object_value(b,"force_use_value",0));var a=this.get_element_object_value(b,"min",""),i=this.get_element_object_value(b,"max","");return""!=a&&(a=parseFloat(a),j=Math.max(a,j)),""!=i&&(i=parseFloat(i),j=Math.min(i,j)),j}}else this.debug_message("Unable to find element #"+h,2)},this.calculate_element_loop=function(e,t,a){var i,r=this.get_element_object(e),n=(this.get_element_dom(e),r.form_id),s=r.calculate_enabled,o=r.overwrite_price,l=r.add_to_price,c=0;if(0==s?c=0:1==s&&(c=this.calculate_element(n,e,t),c=this.calculate_discounts(e,c,c),1<=l?1==o?t=c:t+=c:1==o&&(i=c)),("subtotal"==r.type||"set"==r.type||"custom_calculation"==r.type)&&!a){var _=this.get_element_child_input_dom(e);0==s?i=0:1==s&&(i=1==l&&1==o?t:c),_.val(i),_.data("converted",0),this.set_element_object_value(r,"current_value_forced",i)}return t},this.calculate_discounts=function(e,_,t){var d=this.get_element_object(e),f=this.get_element_dom(e),a=this.get_element_child_input_dom(e),u=this.get_element_object_value(d,"overwrite_price",0);if(!d||!e||!this.object_has_property(d,"discount"))return _;var i=d.discount;if(i){var m,p=i.range_min,h=i.range_max,r=i.operator,v=i.values,n=this.get_element_object_value(d,"discount_value_type","calculated"),g=this.get_element_object_value(d,"discount_value_apply","calculated"),b=0,s=this.get_element_object_value(d,"factor_default",1);if(s&&!isNaN(s)||0===s||(s=1),s=parseFloat(s),W.set_element_object_value(d,"factor",s),"input"==d.type||"numbers"==d.type||"subtotal"==d.type||"hidden"==d.type||"extension"==d.type)b=this.normalize_value(a.val(),f,null,0==a.data("converted"));else if("dropdown"==d.type)b=parseFloat(f.find(":selected").data("value"));else if("radio"==d.type)b=parseFloat(f.find(":checked").data("value"));else if("checkbox"==d.type)b=0,f.find(":checked").each(function(e,t){b+=parseFloat(R(t).data("value"))});else if("daterange"==d.type){var o=[f.find(".ezfc-element-daterange-from").datepicker("getDate"),f.find(".ezfc-element-daterange-to").datepicker("getDate")];b=W.jqueryui_date_diff(o[0],o[1],1==W.get_element_object_value(d,"workdays_only",0),d,n),m=W.jqueryui_date_diff(o[0],o[1],1==W.get_element_object_value(d,"workdays_only",0),d)}m||0==m||(m=b),"calculated"==n&&void 0!==t&&(b=t);var z=b*s,y=b,k=[];R.each(r,function(e,t){var a;if(!(v[e].length<1)&&(p[e]||0===p[e]||(p[e]=Number.NEGATIVE_INFINITY),h[e]||0===h[e]||(h[e]=Number.POSITIVE_INFINITY),y>=parseFloat(p[e])&&y<=parseFloat(h[e]))){var i,r=v[e],n=parseFloat(r);switch(k.push(e),"calculated"==g&&(b=m),t){case"add":a=_+(i=n),u?_=a:_+=a;break;case"subtract":a=_-(i=n),u?_=a:_-=a;break;case"percent_add":_=a=z+(i=n/100*z);break;case"percent_sub":_=a=z-(i=n/100*z);break;case"equals":_=a=i=n;break;case"factor":a=i=b*n,W.set_element_object_value(d,"factor",n),_=a;break;case"price_plus_factor":var s=r.split("|");if(s&&2<=s.length){var o=(s=R.map(s,parseFloat))[0],l=s[1];a=i=o+l*b,W.set_element_object_value(d,"factor",l),_=a}}if("subtotal"==d.type&&!isNaN(a)){var c=R(f).find("input");c.val(a),c.data("converted",0)}W.add_debug_info("discount",f,"discount = "+i+"\nprice after discount = "+_)}}),W.set_element_object_value(d,"__discount_table_active_ids",k)}return _},this.discount_table_update=function(e){var t,a=W.get_element_object_value(e,"__discount_table_active_ids",[]),i=W.get_element_object_value(e,"__discount_table_dom_cached",!1),r="ezfc-element-discount-table-highlighted";i?t=i:(t=W.get_element_dom(e.id).find(".ezfc-element-discount-table tbody"),W.set_element_object_value(e,"__discount_table_dom_cached",t));if(t.find(".ezfc-element-discount-table-highlighted").removeClass(r),a){var n=t.find("tr");for(var s in a)n.eq(a[s]).addClass(r)}},this.calculate_set_elements=function(e,t,a,i,r){var n,s=this.get_element_object(a.data("id")),o=this.get_element_object_value(s,"set_operator"),l=this.get_element_object_value(s,"set_elements"),c=1==this.get_element_object_value(s,"set_allow_zero"),_=this.get_element_object_value(s,"set_dom_selector"),d=this.get_element_object_value(s,"set_use_factor",1),f=[];if(l||_){if(_)f=R(_);else{var u=l;R.each(u,function(e,t){var a=R("#ezfc_element-"+t);a&&f.push(a)})}R.each(f,function(e,t){var a=R(t),i=(W.get_element_object(a.data("id")),W.get_value_from_element(a,null,!1,0==d));if(c||0!=i)if(0!=e)switch(o){case"min":i<n&&(n=i);break;case"max":n<i&&(n=i);break;case"avg":case"sum":n+=i;break;case"dif":n-=i;break;case"prod":n*=i;break;case"quot":0!=i&&(n/=i)}else n=i}),"avg"==o&&(n/=f.length);var m=this.normalize_value(n,a);s.current_value=n,s.current_value_formatted=m,a.find("input").val(m)}},this.calculate_price=function(e,t){t=t||R(e).data("id");var a=0;this.subtotals[t]=[];var i=0<this.trigger_list[t].length?this.trigger_list[t]:W.form_vars[t].form_elements_order,r=!0;for(var n in W.form_vars[t].hasOwnProperty("global_conditions")&&W.calculate_conditionals(e,t,W.form_vars[t].global_conditions,!1,!0),i){var s=i[n],o=W.get_element_object(s),l=W.get_element_dom(s);W.calculate_get_external_values(e,t,l,o.type),o.hasOwnProperty("conditional")&&W.calculate_conditionals(e,t,s,o.type),!o.hasOwnProperty("calculate")&&"custom_calculation"!=o.type&&"matrix"!=o.type&&"set"!=o.type||(r=!1,!W.element_is_visible(s)&&0==o.calculate_when_hidden&&"hidden"!=o.type&&"custom_calculation"!=o.type||W.calculate_set_elements(e,t,l,o.type))}if(r)return this.price_old_global[t];var c=0,_=0,d=0;for(var f in W.form_vars[t].form_elements_order){s=W.form_vars[t].form_elements_order[f],o=W.get_element_object(s),l=W.get_element_dom(s);if(o.hasOwnProperty("calculate")||"custom_calculation"===o.type||"matrix"==o.type||"set"==o.type||"repeatable_form"==o.type){if(this.has_repeatable_parent_id(s)&&!c)c=s,_=this.get_repeatable_parent_id(s),d=a,a=0;else if(this.has_repeatable_parent_id(s)&&this.get_repeatable_element_id(s)==c)d+=a,a=0;else if("repeatable_form"==o.type&&s==_){a=d+a,d=_=c=0;continue}var u=W.calculate_element_loop(s,a),m=W.calculate_element_loop(s,0,!0);if(W.calculate_conditionals(e,t,s,o.type),W.set_element_object_value(s,"current_value",m),1==W.get_element_object_value(o,"calculate_enabled",1)&&0<W.get_element_object_value(o,"add_to_price",1)&&this.element_can_calculate_visibility(s)&&(a=u),0==W.get_element_object_value(o,"add_to_price",1)){var p=W.get_value_from_element(l,null,!0);W.set_element_object_value(o,"current_value",p)}1==W.get_element_object_value(o,"calculate_enabled",1)&&W.subtotals[t].push({el_id:s,price:a})}}return a},this.set_price=function(e,t,a){var r=R(e).data("id");a?price=a:t&&0===t||(price=this.calculate_price(R(e))),this.set_subtotal_values(R(e)),this.update_table_order_all(r),1!=this.form_vars[r].price_show_request||0!=this.form_vars[r].price_requested?(void 0!==this.price_old_global[r]&&!isNaN(this.price_old_global[r])||(this.price_old_global[r]=0),$form_price_elements=R(document).find(".ezfc-price-value[data-id='"+r+"']"),this.price_old_global[r]!=price?(0!=this.form_vars[r].counter_duration?$form_price_elements.countTo({from:W.price_old_global[r],to:price,speed:this.form_vars[r].counter_duration,refreshInterval:this.form_vars[r].counter_interval,formatter:function(e,t){var a=W.format_price(r,e),i=numeral(a).value();return!isNaN(i)&&i||(a=0),a},onComplete:function(e){$form_price_elements.text(W.format_price(r,price))}}):$form_price_elements.text(this.format_price(r,price)),this.price_old_global[r]=price):$form_price_elements.text(this.format_price(r,price))):this.price_request_toggle(r,!1)},this.conditional_check_multiple_options=function(e,t){var a=!1;for(var i in"string"!=typeof e&&"number"!=typeof t||(e=String(e).split("|"),e=R.map(e,R.trim)),"string"!=typeof t&&"number"!=typeof t||(t=String(t).split("|"),t=R.map(t,R.trim)),e)for(var r in t)t[r]==e[i]&&(a=!0);return a},this.format_value_element=function(e,t){var a=this.get_element_object(e);return this.format_price(a.form_id,t,null,a.price_format,a.is_currency,!0)},this.format_price=function(e,t,a,i,r,n,s){var o=this.defaultFormat,l=a||this.form_vars[e].currency;this.form_vars[e].price_format&&this.form_vars[e].price_format.length&&(o=this.form_vars[e].price_format),null!=i&&(o=i),!isNaN(t)&&null!==t||(t=0);var c=n?numeral().set(t):numeral(t),_=this.is_empty(o)?this.defaultFormat:o,d=c.format(_);return"NaN"===d&&(d=t),1==ezfc_vars.price_format_replace_trailing_zeros.enabled&&parseFloat(t).toFixed(6)%1==0&&(d+=ezfc_vars.price_format_dec_point+ezfc_vars.price_format_replace_trailing_zeros.text),1==r&&1==W.form_vars[e].format_currency_numbers_elements&&(0==this.form_vars[e].currency_position?d=l+d:d+=l),d},this.price_request_toggle=function(e,t,a){var i=R(".ezfc-form[data-id='"+e+"']");t?(this.price_old_global[e]=0,this.form_vars[e].price_requested=1,this.calculate_price(i),this.set_price(i,null,a),this.set_submit_text(i)):(this.form_vars[e].price_requested=0,R(i).find(".ezfc-price-value").text(this.form_vars[e].price_show_request_before),R(i).find(".ezfc-submit").val(this.form_vars[e].submit_text.request))},this.set_subtotal_values=function(e,m){m=m||R(e).data("id");var p=["subtotal","set","numbers","custom_calculation"],h=["subtotal","set"];R.each(W.form_vars[m].form_elements_order,function(e,t){var a=W.get_element_object(t),i=W.get_element_dom(t);if(-1!==R.inArray(a.type,p)){var r=W.get_element_object_value(a,"precision",2),n=a.price_format;$element_input="custom_calculation"==a.type?i.find(".ezfc-element-custom-calculation-input"):i.find(".ezfc-element-"+a.type);var s=a.current_value;W.object_has_property(a,"current_value_forced")&&(s=a.current_value_forced),W.is_repeatable_element(t)&&"subtotal"==a.type&&(s=R(W.get_element_child_input_dom(t)).val());var o=W.normalize_value(s,$element_input,r,0==$element_input.data("converted"));if(""!=$element_input.data("min")){var l=parseFloat($element_input.data("min"));o<l&&(o=l)}if(""!=$element_input.data("max")){var c=parseFloat($element_input.data("max"));c<o&&(o=c)}var _="",d="",f=W.get_element_object_value(a,"text_before",""),u=W.get_element_object_value(a,"text_after","");0!=W.form_vars[m].format_number_show_zero||""!=o&&0!=o?(_=W.format_price(a.form_id,o,null,n,!1,0==$element_input.data("converted")),d=f+(d=W.format_price(a.form_id,o,null,n,a.is_currency,0==$element_input.data("converted")))+u):o="",-1!==R.inArray(a.type,h)&&($element_input.val(d),$element_input.data("converted",1)),i.find(".ezfc-text").text(_)}})},this.scroll=function(){R(".ezfc-fixed").each(function(){var e=R(this).data("id");if(W.form_vars[e]){var t="ezfc-fixed-scrolling",a=R(this).offset(),i=R(".ezfc-form[data-id='"+e+"']"),r=i.outerHeight(),n=i.offset(),s=R(window).scrollTop(),o=parseFloat(W.form_vars[e].price_position_scroll_top),l=n.top-s-o;l<0&&-r<l?(R(this).offset({top:s+o}),R(this).addClass(t)):0<l&&a.top>n.top?(R(this).offset({top:n.top}),R(this).removeClass(t)):(a.top<n.top||a.top>n.top+r)&&R(this).offset({top:n.top})}})},this.reset_disabled_fields=function(e,t){var a=R(e).closest(".ezfc-wrapper");R(e).find(".ezfc-custom-hidden").each(function(){R.each(R(this).find("input, :selected"),function(e,t){R(this).val(R(this).data("index")).removeAttr("disabled"),R(this).is(":checked")&&R(this).prop("checked",!1)})}),a.find(".ezfc-payment-submit, .ezfc-payment-cancel").prop("disabled",!1),this.set_submit_text(e,t)},this.reset_form=function(e){this.init_form(e),this.reset_elements(e),this.set_step(e,0,0),this.form_change(e)},this.reset_elements=function(e){e.find(".ezfc-custom-element").each(function(){var e=R(this).data("id"),t=W.get_element_object(e);if("group"!=t.type&&1!=W.get_element_object_value(t,"keep_value_after_reset",0)){var a=R(this).data("element"),i=R(this).find("[data-initvalue]").data("initvalue");switch(a){case"checkbox":R(this).find("input").each(function(){1==(i=R(this).data("initvalue"))?R(this).prop("checked",!0):R(this).removeAttr("checked")});break;case"dropdown":R(this).find("option").removeAttr("selected"),R(this).find("option[data-index='"+i+"']").prop("selected",!0);break;case"numbers":R(this).find("input").val(i);var r=R(this).find(".ezfc-slider-element");r.length&&r.slider({value:i});break;case"radio":R(this).find("input").removeAttr("checked"),R(this).find("input[data-initvalue]").prop("checked",!0);break;case"textfield":R(this).find("textarea").val(i);break;default:R(this).find("input").val(i)}}}),e.find(".ezfc-selected").removeClass("ezfc-selected")},this.set_step=function(t,a,e){var i=parseInt(t.find(".ezfc-step-active").data("step")),r=t.find(".ezfc-step[data-step='"+i+"']"),n=t.data("id");if(this.step_is_changing=!1,i!=a){if(1==e&&1==this.form_vars[n].verify_steps)return t.find(".ezfc-step-submit-icon").fadeIn(),this.form_submit(t,a-1),void R(".ezfc-has-hidden-placeholder").val("").removeClass("ezfc-has-hidden-placeholder");var s=parseInt(this.form_vars[n].step_indicator_start)-1,o=parseInt(this.form_vars[n].step_speed);if(isNaN(o)&&(o=200),r.fadeOut(o,function(){var e=t.find(".ezfc-step[data-step='"+a+"']");e.fadeIn(o).addClass("ezfc-step-active"),R(this).removeClass("ezfc-step-active"),s<=a?t.find(".ezfc-step-indicator").fadeIn():t.find(".ezfc-step-indicator").hide(),W.scroll_to(e)}),t.find(".ezfc-step-indicator-item").each(function(){var e=parseInt(R(this).data("step"));R(this).removeClass("ezfc-step-indicator-item-active"),e<=a&&R(this).addClass("ezfc-step-indicator-item-active")}),a<i&&1==W.form_vars[n].step_reset_succeeding)for(var l=a+1;l<W.form_vars[n].step_count;l++){var c=R(".ezfc-step[data-step='"+l+"']");this.reset_elements(c)}return W.current_steps[n]=a,W.form_change(t),!1}},this.set_step_action=function(e,t,a){if(!this.step_is_changing){var i=R("#ezfc-form-"+e),r=parseInt(i.find(".ezfc-step-active").data("step")),n=0;switch(t){case"step_prev":if(0==r)return;n=r-1;break;case"step_next":if(r==i.find(".ezfc-step-start").length-1)return;n=r+1;break;case"step_goto":if(a=parseInt(a),isNaN(a))return;var s=i.find(".ezfc-step-start[data-id='"+a+"']");if(s.length<1)return;n=parseInt(s.data("step"))}this.step_is_changing=!0,setTimeout(function(){W.set_step(i,n,1)},350)}},this.scroll_to=function(e,t){var a=R(e).offset();if(void 0!==a&&0!=ezfc_vars.auto_scroll_steps){var i=parseFloat(t)||0;this.is_empty(ezfc_vars.scroll_steps_offset)||(i=parseFloat(ezfc_vars.scroll_steps_offset));var r=a.top+i;R("html, body").animate({scrollTop:r})}},this.get_element_dom=function(e){return this.is_repeatable_element(e)?R("#ezfc_element-"+e):void 0!==this.$form_elements[e]&&this.$form_elements[e].$element},this.get_element_child_input_dom=function(e){return this.is_repeatable_element(e)?R("#ezfc_element-"+e).find(":input"):void 0!==this.$form_elements[e]&&this.$form_elements[e].$element_input},this.get_object_value=function(e,t,a,i){return"object"!=typeof e?a:e&&this.object_has_property(e,t)?"object"==typeof e[t]&&void 0!==i&&void 0!==e[t][i]?e[t][i]:e[t]:a},this.get_element_object=function(e){return void 0!==this.$form_elements[e]&&this.$form_elements[e].element},this.get_element_object_value=function(e,t,a){return"object"!=typeof e&&(e=this.get_element_object(e)),e&&this.object_has_property(e,t)?e[t]:a},this.get_repeatable_element_id=function(e){return this.is_repeatable_element(e)?-1===String(e).indexOf("-")?e:String(e).split("-")[0]:e},this.get_repeatable_element_counter=function(e){return this.is_repeatable_element(e)?-1===String(e).indexOf("-")?0:String(e).split("-")[1]:e},this.get_repeatable_element_counter_from_dom_id=function(e){var t=String(e).split("-");return!(t.length<3)&&t[2]},this.is_repeatable_element=function(e){return("string"==typeof e||"number"==typeof e)&&(0<=String(e).indexOf("-")||this.has_repeatable_parent_id(e))},this.get_repeatable_parent_id=function(e){return 0<=String(e).indexOf("-")&&(e=String(e).split("-")[0]),this.get_element_object_value(this.get_element_object(e),"__parent_id",0)},this.has_repeatable_parent_id=function(e){return 0!=this.get_repeatable_parent_id(e)},this.set_element_object_value=function(e,t,a){if("object"!=typeof e){if("price"==e||"submit_button"==e)return;e=this.get_element_object(e)}if(!e)return!1;e[t]=a},this.set_element_list_object_value=function(e,t,a){for(var i in e)W.set_element_object_value(e[i],t,a)},this.get_top_parent_group_id=function(e){var t=this.get_element_object(e);return!!t&&(0!=t.group_id?this.get_top_parent_group(t.group_id):t.id)},this.has_parent_group_id=function(e,t){var a=this.get_element_object(e);return!(!a.group_id||0==a.group_id)&&(e!=t&&(a.group_id==t||this.has_parent_group_id(a.group_id,t)))},this.get_group_children=function(e){var t=this.get_element_object(e);if(!t)return[];var a=[];for(var i in W.form_vars[t.form_id].form_elements_order){var r=W.form_vars[t.form_id].form_elements_order[i];W.get_element_object(r);r!=e&&W.has_parent_group_id(r,e)&&a.push(r)}return a},this.get_value_from_element=function(n,e,t,a,s){if(s=R.extend({},{return_array:!1,return_value:"value"},s),!n&&e&&(n=void 0!==this.$form_elements[e]?this.$form_elements[e].$element:this.get_element_dom(e)),!n||!n.length)return this.debug_message("Unable to find element #"+e,2),0;e=e||n.data("id");var i=this.get_element_object(e);if(!i)return 0;var r=this.get_element_child_input_dom(e),o=i.type,l=this.get_element_object_value(e,"factor",1),c=r.val(),_=0==r.data("converted"),d=this.normalize_value(c,n,null,_);if(0==i.calculate_when_hidden&&!this.element_is_visible(e)&&"hidden"!=o&&"custom_calculation"!=o)return 0;d&&!isNaN(d)||(d=0);var f=t?d:parseFloat(d);switch("count"==s.return_value&&(f=0),o){case"subtotal":case"numbers":case"hidden":l&&!isNaN(l)||0===l||(l=1),f=t?c:a?d:d*l;break;case"dropdown":case"radio":case"checkbox":var u=s.return_value,m=!t&&-1===R.inArray(u,["count","name","option_id"]);n.find(":selected, :checked").each(function(){if(m)f+=parseFloat(R(this).data("value"));else if("object"!=typeof f&&"count"!=u&&(f=[]),"name"==u){var e=R(this).data("index");f.push(i.options[e].text)}else"option_id"==u?f.push(R(this).data("optionid")):"count"==u?f++:f.push(R(this).data(u))});break;case"datepicker":""==(h=R.trim(W.form_vars[i.form_id].datepicker_format))&&(h="dd/mm/yy");var p=n.find(".ezfc-element-datepicker").datepicker("getDate");f=R.datepicker.formatDate(h,p),t=!0;break;case"daterange":var h;""==(h=R.trim(W.form_vars[i.form_id].datepicker_format))&&(h="dd/mm/yy");var v=[n.find(".ezfc-element-daterange-from").datepicker("getDate"),n.find(".ezfc-element-daterange-to").datepicker("getDate")],g=[R.datepicker.formatDate(h,v[0]),R.datepicker.formatDate(h,v[1])];if(t)f=g;else{n.find(".ezfc-element-daterange-container");var b=W.jqueryui_date_diff(v[0],v[1],1==this.get_element_object_value(i,"workdays_only",0),i);f=a?b:b*l}break;case"custom_calculation":f=n.find(".ezfc-element-custom-calculation-input").val(),t||(f=parseFloat(f));break;case"starrating":f=parseFloat(n.find(":checked").val()),isNaN(f)&&(f=0);break;case"table_order":var z=0;R.each(i.table_order,function(e,t){var a=n.find(".ezfc-element-table_order-row[data-row='"+e+"'] .ezfc-element-table_order-quantity-input"),i=parseFloat(a.val()),r=parseFloat(t.value)*i;"count"==s.return_value?z+=i:z+=r}),f=z;break;case"set":f=i.current_value;break;case"input":case"textfield":f="letter_count"==s.return_value?String(c).replace(/\s+/g,"").length:"letter_count_with_space"==s.return_value?String(c).replace(/\r?\n|\r/g,"").length:c;break;case"repeatable_form":var y=0,k=this.get_element_object_value(i,"__repeated_ids",[]),w=this.get_element_object_value(i,"__repeated_elements_count",0),x=(k[0],0),j=0;for(var C in k){var D=k[C],N=this.get_element_object(k[C]),O=this.get_calculated_element_value(N.form_id,D);1==N.overwrite_price?y=O:y+=O,0<j&&j%(w-1)==0?(x+=y,j=y=0):j++}f=y=x+y;break;case"discount_codes":f=W.get_element_object_value(i,"discount_value",0);break;case"address_distance":f=W.get_element_object_value(i,"distance_value",0);break;case"fileupload":case"group":case"heading":case"hr":case"html":case"image":case"placeholder":case"spacer":case"stepstart":case"stepend":f=0;break;default:f=c}if(!1,!t)return isNaN(f)&&(f=0),f?parseFloat(f):0;if("name"==u){var F=(new DOMParser).parseFromString(f,"text/html");F.body&&F.body.textContent&&(f=F.body.textContent)}return f},this.checkbox_change=function(e){var t=parseInt(e.attr("data-max_selectable"));t||e.find("input:not(:checked):not(.force-disabled)").removeAttr("disabled"),t&&0<=t&&(t<=e.find(":checked").length?e.find("input:not(:checked)").attr("disabled","disabled"):e.find("input:not(:checked):not(.force-disabled)").removeAttr("disabled"))},this.checkbox_change_state=function(e,t,a,i){if(e.attr("disabled"))return!1;null==t&&(t=!e.is(":checked"));var r=e.closest(".ezfc-element-single-option-container");if(r.hasClass("ezfc-element-option-has-image")){var n=e.siblings(".ezfc-element-option-image");t?n.addClass("ezfc-selected"):n.removeClass("ezfc-selected")}t?r.addClass("ezfc-option-wrapper-selected"):r.removeClass("ezfc-option-wrapper-selected"),i||e.prop("checked",t),a||e.trigger("change")},this.radio_change_state=function(e,t,a){var i=e.closest(".ezfc-form").data("id");if(e.attr("disabled"))return!1;void 0===t&&(t=!e.is(":checked"));var r=e.closest(".ezfc-element-radio-container"),n=r.closest(".ezfc-element-option-container");if(n.find(".ezfc-selected").removeClass("ezfc-selected"),n.find(".ezfc-element-radio-input").removeAttr("checked"),t&&(r.siblings(".ezfc-option-wrapper-selected").removeClass("ezfc-option-wrapper-selected"),r.addClass("ezfc-option-wrapper-selected")),r.hasClass("ezfc-element-option-has-image")){var s=e.siblings(".ezfc-element-option-image");t&&(e.attr("checked","checked"),e.prop("checked",!0),n.find(".ezfc-selected").removeClass("ezfc-selected"),s.addClass("ezfc-selected"))}else t&&(e.attr("checked","checked"),e.prop("checked",!0));a||e.trigger("change"),this.form_vars[i]&&1==this.form_vars[i].step_auto_progress&&!n.hasClass("disable-auto-progress")&&t&&this.set_step_action(i,"step_next")},this.live_summary_update=function(r){if(0!=this.form_vars[r].live_summary_enabled){var n=this,s="";R.each(ezfc_vars.element_vars[r],function(e,t){if(void 0!==t.current_value&&0!=t.show_in_live_summary&&n.element_is_visible(t.id)){var a=R.trim(t.current_value);if(void 0!==t.options){if(0==(a=n.get_value_from_element(null,t.id,!0,null,{return_value:"name"})))return}else void 0!==t.current_value_formatted&&(a=t.current_value_formatted);if(""!=a&&0!=a){"object"==typeof a&&(a="<ul class='ezfc-live-summary-list'><li class='ezfc-live-summary-list-item'>"+a.join("</li><li class='ezfc-live-summary-list-item'>")+"</li></ul>");var i={current_value:a,element:t,form_id:r};a=n.call_hook("ezfc_live_summary_item",i).current_value,s+="<div class='ezfc-live-summary-item'><div class='ezfc-live-summary-item-name'>"+t.label+"<span class='ezfc-live-summary-item-separator'></span></div><div class='ezfc-live-summary-item-value'>"+a+"</div></div>"}}}),R("#ezfc-live-summary-"+r).find(".ezfc-live-summary-content").html(s)}},this.input_format_listener_change=function(d){var e=d.parent().closest(".ezfc-element").data("id"),f=this.get_element_object(e);if(f){var u=f.form_id,a=this.get_element_object_value(f,"text_before",""),i=this.get_element_object_value(f,"text_after",""),m=this.get_element_object_value(f,"price_format",null);d.on("focus click",function(){var e=W.escape_regex(a),t=W.escape_regex(i);""!=a&&(this.value=this.value.replace(new RegExp("^"+e,""),"")),""!=i&&(this.value=this.value.replace(new RegExp(t+"$",""),"")),1==f.is_number&&(this.value=this.value.replace(/[^0-9\.,-]/g,""),this.value=this.value.replace(ezfc_vars.price_format_dec_thousand,""))});function t(e,t){var a=e.value;if(e.value=W.get_element_object_value(f,"current_value_forced",e.value),1==W.get_element_object_value(f,"is_number",1)){e.value=e.value.replace(/[^0-9\.,-]/g,"");var i=d.data("min"),r=d.data("max");if(""!=e.value){var n=W.normalize_value(e.value);isNaN(n)||(""!=i&&!isNaN(i)&&n<i&&(e.value=i),""!=r&&!isNaN(r)&&r<n&&(e.value=r))}}var s=e.value!=a,o=W.is_empty_or_zero(e.value);if(0==W.form_vars[u].format_number_show_zero&&o)e.value="";else if(1==W.get_element_object_value(f,"is_currency",1)){var l=W.normalize_value(e.value);e.value=W.format_price(u,l,null,m,W.form_vars[u].format_currency_numbers_elements,null,f)}else{var c=W.get_element_object_value(f,"text_before",""),_=W.get_element_object_value(f,"text_after","");e.value=c+e.value+_}W.set_element_object_value(f,"current_value_formatted",e.value),s&&!t&&W.form_change(null,u,d),W.live_summary_update(u),1==W.get_element_object_value(f,"discount_show_table",0)&&1==W.get_element_object_value(f,"discount_show_table_indicator",1)&&W.discount_table_update(f)}d.on("blur",function(){t(this)}),d.bind("ezfc_blur_trigger",function(){t(this,!0)})}},this.element_is_visible=function(e){var t=this.get_element_object(e);if(!t)return!1;var a=this.get_element_dom(e),i=t.form_id;this.form_vars[i].has_steps;return!a.hasClass("ezfc-custom-hidden")&&!a.hasClass("ezfc-hidden")&&(0==t.group_id||a.closest(".ezfc-custom-hidden, .ezfc-hidden").length<1)},this.element_can_calculate_visibility=function(e){var t=this.get_element_object(e);return!!t&&(0!=this.get_element_object_value(t,"calculate_when_hidden",0)||this.element_is_visible(e))},this.clear_hidden_values=function(e){var t=R(e).data("id");1==this.form_vars[t].clear_selected_values_hidden&&R(e).find(".ezfc-custom-hidden").each(function(){W.clear_hidden_values_element(R(this).data("id"),!0)})},this.clear_hidden_values_element=function(e,t){var a=this.get_element_object(e),i=this.get_element_dom(e),r=this.get_element_child_input_dom(e);i&&i.length&&("dropdown"==a.type?i.find(":selected").removeAttr("selected"):"radio"==a.type?this.radio_change_state(i.find(".ezfc-element-radio-input"),!1,t):"checkbox"==a.type?this.checkbox_change_state(i.find(".ezfc-element-checkbox-input"),!1,t):r.val(""))},this.escape_regex=function(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")},this.normalize_value=function(e,t,a,i){if(e=String(e),void 0!==t){var r=R(t).data("id"),n=this.get_element_object(r),s=R.trim(this.get_element_object_value(n,"text_before","")),o=R.trim(this.get_element_object_value(n,"text_after",""));if(""!=s){var l=W.escape_regex(s);e=e.replace(new RegExp("^"+l,""),"")}if(""!=o){var c=W.escape_regex(o);e=e.replace(new RegExp(c+"$",""),"")}}var _=parseFloat(e);return void 0===a||!a&&0!=a||(a=parseInt(a),_=_.toFixed(a)),i||(_=numeral(e).value()),_},this.set_submit_text=function(e,t){var a=R(e).data("id"),i=R(e).find(".ezfc-submit"),r="default",n=this.form_vars[a].submit_text.default;if(1==this.form_vars[a].price_show_request){if(this.form_vars[a].price_requested&&!t||(n=this.form_vars[a].submit_text.request,r="request"),t)return this.price_request_toggle(a,!1),!1}else if(1==this.form_vars[a].summary_enabled&&0==this.form_vars[a].summary_shown)r="summary",n=this.form_vars[a].submit_text.summary;else if(1==this.form_vars[a].use_paypal)r="paypal",n=this.form_vars[a].submit_text.paypal;else if(1==this.form_vars[a].payment_force_stripe)r="stripe",n=this.form_vars[a].submit_text.stripe;else if(1==this.form_vars[a].use_woocommerce)r="woocommerce",n=this.form_vars[a].submit_text.woocommerce;else{n=this.form_vars[a].submit_text.default;var s=R(e).find(".ezfc-element-wrapper-payment");if(0<s.length){var o=R(s).find(":checked").data("value");void 0!==this.form_vars[a].submit_text[o]&&(r=o,n=this.form_vars[a].submit_text[o])}}i.val(n),i.data("type",r)},this.prevent_enter_step_listener=function(e,t){R(e).keypress(function(e){e.keyCode||e.which;13==e.which&&e.preventDefault()})},this.call_hook=function(e,t){var a=window[e];return t=void 0===t?{}:t,"function"!=typeof a?t:a(t)},this.stripe_response_handler=function(e,t){var a=R(".ezfc-form[data-id='"+W.payment_form_id+"']"),i=R(".ezfc-payment-form[data-form_id='"+W.payment_form_id+"']");if(t.error)W.debug_message(t.error.message),R("#ezfc-payment-message-"+W.payment_form_id).text(t.error.message),i.find(".ezfc-payment-submit, .ezfc-payment-cancel").prop("disabled",!1),setTimeout(function(){R("#ezfc-payment-message-"+W.payment_form_id).text("")},7500);else{var r=t.id;a.find("#ezfc-stripetoken-"+W.payment_form_id).val(r),W.form_submit(a,-1,"stripe-checkout")}},this.authorize_create_token=function(e){var t={};authData={},cardData={};R("#ezfc-authorize-form-"+e);cardData.cardNumber=R("#ezfc-element-payment-authorize-card-number-"+e).val(),cardData.cardNumber=cardData.cardNumber.replace(/ /g,""),cardData.month=R("#ezfc-element-payment-authorize-expiry-month-"+e).val(),cardData.year=R("#ezfc-element-payment-authorize-expiry-year-"+e).val(),cardData.cardCode=R("#ezfc-element-payment-authorize-cvc-"+e).val(),t.cardData=cardData,authData.clientKey=ezfc_vars.authorize.client_key,authData.apiLoginID=ezfc_vars.authorize.api_login_id,t.authData=authData,Accept.dispatchData(t,W.authorize_response_handler)},this.authorize_response_handler=function(e){var t=R(".ezfc-form[data-id='"+W.payment_form_id+"']"),a=R(".ezfc-payment-form[data-form_id='"+W.payment_form_id+"']"),i=t.data("id");if("Error"===e.messages.resultCode){a.find(".ezfc-payment-submit, .ezfc-payment-cancel").prop("disabled",!1);for(var r=[],n=0;n<e.messages.message.length;n++)r.push(e.messages.message[n].text),W.debug_message(e.messages.message[n].code+": "+e.messages.message[n].text);W.set_message(i,r.join(" "))}else{var s=e.opaqueData.dataValue;R("#ezfc-authorizetoken-"+W.payment_form_id).val(s),W.form_submit(t,-1,"authorize-checkout")}},this.is_valid_date=function(e){return e&&"object"==typeof e&&"function"==typeof e.setHours},this.check_datepicker_days=function(e,t,a){if(!e||"object"!=typeof e||"function"!=typeof e.setHours)return[!1,""];e.setHours(0,0,0,0);var i=e.getTime();if(a.length)for(var r in a){if(a[r]=R.trim(a[r]),-1!==a[r].indexOf(":")){var n=a[r].split(":");if(2==n.length){var s=new Date(n[0]),o=new Date(n[1]);if(s.setHours(0,0,0,0),o.setHours(0,0,0,0),i>=s.getTime()&&i<=o.getTime())return[!1,""]}}else{var l=new Date(a[r]);if(l.setHours(0,0,0,0),i==l.getTime())return[!1,""]}}var c=e.getDay();return[-1!==R.inArray(c,t),""]},this.check_datepicker_predefined_values=function(e){var t=e.val(),a=!1;if(""!=t){switch(t){case"__today__":a=new Date;break;case"__tomorrow__":a=new Date((new Date).getTime()+864e5);break;case"__current_month__":a=(new Date).getMonth();break;case"__current_year__":a=(new Date).getFullYear();break;default:a=t}a&&e.datepicker("setDate",a)}},this.check_inline_math=function(e,t){return e},this.get_target_subtotal_value=function(e,t,a){for(var i in this.subtotals[e])if(this.subtotals[e][i].el_id==t)return a?void 0!==this.subtotals[e][i-1]?this.subtotals[e][i-1].price:0:this.subtotals[e][i].price;return null},this.get_calculated_element_value=function(e,t){R("#ezfc-form-"+e);var a=this.get_element_object(t),i=(this.get_element_dom(t),this.get_element_object_value(a,"calculate_enabled",1));return this.is_repeatable_element(t)||this.has_repeatable_parent_id(t)?this.calculate_element_loop(t,0,!0):0==i?0:this.get_element_object_value(a,"current_value_forced",this.get_element_object_value(a,"current_value",0))},this.set_message=function(e,t){var a=R("#ezfc-form-"+e);if(!a)return!1;var i,r=a.closest(".ezfc-wrapper");if(!(i=0<r.find(".ezfc-payment-dialog-open").length?r.find(".ezfc-payment-errors"):R("#ezfc-message-"+e)).length&&console)return console.log(t),!1;i.text(t).fadeIn().delay(7500).fadeOut()},this.recaptcha_reload=function(){R(".ezfc-form .g-recaptcha").length&&"undefined"!=typeof grecaptcha&&grecaptcha.reset()},this.populate_html_placeholders=function(l){l.find(".ezfc-html-placeholder").each(function(e,t){var a=R(t),i=a.closest(".ezfc-custom-element").data("id"),r=W.get_element_object(i),n="",s=W.functions.get_element_id_by_name(l.data("id"),a.data("listen_target"));if(s){var o=a.data("listen_retrieve");n=W.get_value_from_element(!1,s,!0,!1,{return_value:o}),0==W.get_element_object_value(r,"replace_placeholders_show_zero",1)&&0==n&&(n=""),n&&"object"==typeof n&&"function"==typeof n.join&&(n=n.join(", ")),n=R.trim(n),a.text(n)}})},this.init_repeatable_group=function(e){this.get_element_object(e),this.get_element_dom(e);this.group_check_actions(e)},this.group_repeat=function(_){var e=this.get_element_object(_),t=parseInt(this.get_element_object_value(e,"repeatable_count_max",0)),a=this.get_element_object_value(e,"__repeated_count",0);if(!(0<t&&t-1<=a)){void 0===this.group_repeat_elements[_]&&(this.group_repeat_elements[_]=0),this.group_repeat_elements[_]++,this.set_element_object_value(e,"__repeated_count",++a);var i=R("#ezfc_element-"+_);i.find(".ezfc-spinner").each(function(){R(this).spinner("instance")&&R(this).spinner("destroy")}),i.find(".ezfc-slider-element").each(function(){R(this).slider("instance")&&R(this).slider("destroy")});var d=i.clone(!0),r=d.attr("id")+"-"+this.group_repeat_elements[_],n=i.closest(".ezfc-form"),s=n.data("id");d.find(".ezfc-group-repeatable-wrapper").remove();var o=this.form_vars[s].form_elements_order.indexOf(String(_));this.get_element_object_value(e,"__repeated_ids",[]);d.attr("id",r),d.hide(),this.reset_elements(d),d.appendTo(R("#ezfc-repeatable-wrapper-"+_+" .ezfc-repeatable-form-elements")).fadeIn(500);var f=[],u=[];d.find("[id^='ezfc_element-']").each(function(){var e=R(this).data("id"),t=R(this).attr("id"),a=t+"-"+W.group_repeat_elements[_],i=R(this).data("id")+"-"+W.group_repeat_elements[_];if(R(this).hasClass("ezfc-custom-element"))f.push(i),u.push({new_element_id:i,old_element_id:e,repeat_index:W.group_repeat_elements[_]});else{var r=R(this).attr("name");if(!r)return;var n=r.replace(/\]/g,"").split("[").map(function(e){return e.replace(/\[/g,"")});if(n.length<3)return;var s=n[0];n=n.slice(1,n.length);var o=W.group_repeat_elements[_]+parseInt(n[2]);n[2]=o;var l=s+"["+n.join("][")+"]";R(this).attr("name",l)}R(this).attr("id",a),R(this).data("id",i);var c="label[for='"+t+"']";d.find(c).each(function(){R(this).attr("for",a)})}),d.find(".ezfc-element-table_order").each(function(){d.find(".ezfc-table_order-btn").each(function(){var e=R(this).siblings(".ezfc-element-table_order-quantity-input").attr("id");R(this).data("target",e)}),d.find(".ezfc-element-table_order-subtotal").each(function(){var e=R(this).closest("tr[data-row]").data("row"),t=R(this).attr("id")+"-"+W.group_repeat_elements[_]+"-"+e;R(this).attr("id",t)})}),this.form_vars[s].form_elements_order.splice.apply(this.form_vars[s].form_elements_order,[o,0].concat(f));var l=this.get_element_object_value(e,"__repeated_ids",[]);for(var c in l=this.unique(l.concat(f)),this.set_element_object_value(e,"__repeated_ids",l),u){var m=u[c].old_element_id,p=u[c].new_element_id,h=W.get_element_object(m);if(h){var v=R.extend(!0,{},h);if(v.id=p,ezfc_vars.element_vars[v.form_id][v.id]=v,W.add_form_element_to_cache(p,v.form_id),v.hasOwnProperty("calculate"))for(var g in v.calculate){var b=v.calculate[g];-1!==W.form_vars[s].form_elements_order.indexOf(String(b.target))&&(b.target=b.target+"-"+u[c].repeat_index)}if(v.hasOwnProperty("conditional"))for(var z in v.conditional.target){var y=String(v.conditional.target[z]);-1!==W.form_vars[s].form_elements_order.indexOf(y)&&(v.conditional.target[z]=y+"-"+u[c].repeat_index)}}}i.find(".ezfc-spinner").each(function(){W.init_spinner(R(this))}),i.find(".ezfc-slider").each(function(){W.init_slider(R(this))}),d.find(".ezfc-spinner").each(function(){W.init_spinner(R(this))}),d.find(".ezfc-slider").each(function(){W.init_slider(R(this))}),this.init_table_order(s),this.form_change(n),this.group_check_actions(_)}},this.group_remove=function(e){var t=R("#ezfc-repeatable-wrapper-"+e).find(".ezfc-repeatable-form-elements > .ezfc-custom-element");if(!(t.length<=1)){var a=this.get_element_object(e),i=this.get_element_object_value(a,"__repeated_count",0);this.set_element_object_value(a,"__repeated_count",--i);var r=t.last(),n=this.get_repeatable_element_counter_from_dom_id(r.attr("id")),s=R("#ezfc_element-"+e+"-"+n),o=s.closest(".ezfc-form");for(var l in a.__element_ids){var c=a.__element_ids[l]+"-"+n,_=a.__repeated_ids.indexOf(c);-1<_&&a.__repeated_ids.splice(_,1);var d=this.form_vars[a.form_id].form_elements_order.indexOf(c);-1<d&&this.form_vars[a.form_id].form_elements_order.splice(d,1)}s.fadeOut(300,function(){R(this).remove()}),this.form_change(o),this.group_check_actions(e)}},this.group_check_actions=function(e){var t=this.get_element_object(e),a=R("#ezfc-repeatable-wrapper-"+e),i=parseInt(this.get_element_object_value(t,"repeatable_count_max",0)),r=this.get_element_object_value(t,"__repeated_count",0),n=a.find(".ezfc-repeatable-form-repeat-button"),s=a.find(".ezfc-repeatable-form-remove-button");0==r?(n.removeAttr("disabled"),s.attr("disabled","disabled")):(0<i&&i-1<=r?n.attr("disabled","disabled"):n.removeAttr("disabled"),s.removeAttr("disabled"))},this.toggle_group=function(e,t){var a=e.find("> .ezfc-group-elements").first();if(e.hasClass("ezfc-group-collapsible")){a.slideToggle(500);var i="ezfc-group-active",r="fa-chevron-circle-down",n="fa-chevron-circle-right",s=e.find(".ezfc-collapse-icon i").first();s.hasClass(r)&&!t?(s.removeClass(r).addClass(n),e.removeClass(i)):(s.removeClass(n).addClass(r),e.addClass(i))}},this.init_tips=function(){R(".ezfc-element-description[data-ezfctip]").each(function(){var e=R(this).data("ezfctip");new Opentip(R(this),{background:ezfc_vars.opentip.background||"yellow",borderWidth:0,closeButtonCrossColor:ezfc_vars.opentip.color||"black",redraw:!0,removeElementsOnHide:!0,target:R(this),tipJoint:ezfc_vars.required_text_position||"middle right"}).setContent(e)})},this.init_table_order=function(e){for(var t in this.form_vars[e].form_elements_order){var a=this.form_vars[e].form_elements_order[t],i=this.get_element_object(a),r=this.get_element_dom(a);if("table_order"==i.type)for(var n in i.table_order){var s=i.table_order[n],o=s.option.value,l=r.find(".ezfc-element-table_order-row[data-row='"+n+"']").find(".ezfc-element-table_order-subtotal"),c=W.format_price(e,o,null,null,i.is_currency),_=W.get_element_object_value(s.option,"text_prefix",""),d=W.get_element_object_value(s.option,"text_suffix","");l.text(_+c+d)}}},this.update_table_order=function(e,t){var a=this.get_element_object(e),i=W.get_element_object_value(a,"current_value",0),r=this.format_price(t,i,null,null,a.is_currency);R("#ezfc_element-"+e+"-footer-price").text(r)},this.update_table_order_all=function(e){for(var t in this.form_vars[e].form_elements_order){var a=this.form_vars[e].form_elements_order[t];"table_order"==this.get_element_object(a).type&&this.update_table_order(a,e)}},this.show_tip=function(e,t,a,i){var r=new Opentip(e,{background:ezfc_vars.opentip.background||"yellow",closeButtonCrossColor:ezfc_vars.opentip.color||"black",delay:a,hideDelay:.1,hideTriggers:["closeButton","target"],removeElementsOnHide:!0,showOn:null,target:t,tipJoint:ezfc_vars.required_text_position||"middle right"});r.setContent(i),r.show()},this.submit_cancel=function(e,t){var a=e.closest(".ezfc-wrapper"),i=e.find("input[type='submit']"),r=e.find(".ezfc-submit-icon"),n=e.data("id");for(var s in r.fadeOut(),i.prop("disabled",!1),a.find(".ezfc-payment-submit, .ezfc-payment-cancel").prop("disabled",!1),this.payment_methods){var o=W.payment_methods[s];W.form_vars[n].payment_info_shown[o]=0}},this.popup_form_open=function(e){var t=R("#ezfc-form-popup-"+e);if(t.length){var a=R(".ezfc-modal"),i=t.parent();i.length&&"body"!=i[0].tagName&&(t.appendTo("body"),a.appendTo("body")),a.addClass("ezfc-modal-open"),t.fadeIn()}},this.popup_form_close=function(e){R(".ezfc-modal").removeClass("ezfc-modal-open"),R("#ezfc-form-popup-"+e).fadeOut()},this.remove_debug_info=function(){R(".ezfc-debug-info").remove()},this.add_debug_info=function(e,t,a){if(2==ezfc_vars.debug_mode&&"group"!=(e=e||R(t).data("element"))){var i=R(t).attr("id"),r="ezfc-debug-"+(i=i&&i.split("ezfc_element-")[1]),n=R("#"+r).length;if("custom_calculation"!=e||!n){var s="[["+e+" #"+i+"]]\n["+e+"]\n"+a+"\n\n";n?R(t).find(".ezfc-debug-info").append(s):R(t).append("<pre id='"+r+"' class='ezfc-debug-info ezfc-debug-type-"+e+"'>"+s+"</pre>"),console.log(a,t)}}},this.debug_message=function(e,t){t=void 0===t?1:t,0==ezfc_vars.debug_mode||ezfc_vars.debug_mode<t||console.log(e)},this.jqueryui_date_diff=function(e,t,a,i,r){if(!e||!t)return 0;var n=new Date(e),s=new Date(t),o=0,l=0,c=!1,_=[],d=!1,f=!1;if(r=r||"calculated",1==this.get_element_object_value(i,"daterange_count_full_days",0)&&(s=s.setDate(s.getDate()+1)),i&&(d=this.get_element_object_value(i,"datepicker_day_prices_default",!1),f=this.get_element_object_value(i,"datepicker_day_prices",!1),"object"==typeof d&&(d=R.map(d,parseFloat)),"object"==typeof f))for(var u in f){var m=f[u].split("=");if(1<m.length){c=!0;var p=m[0].split(":");p[0]=new Date(p[0]),p[1]=new Date(p[1]);var h=R.map(m[1].split(","),parseFloat);_.push({start:p[0],end:p[1],prices:h})}}for(;n<s;){var v=n.getUTCDay(),g=this.dates_get_single_price(_,n),b=!1;a?6!==v&&7!==v&&(b=!0):b=!0,b&&o++,-1!=g?l+=g:d&&void 0!==d[v]&&(l+=d[v]),n.setDate(n.getDate()+1)}return c&&"raw"!=r?l:o},this.dates_get_single_price=function(e,t){for(var a in e){var i=e[a];if(t>=i.start&&t<=i.end){var r=t.getUTCDay();if(void 0!==i.prices[r])return i.prices[r];if("undefined"!==i.prices[0])return i.prices[0]}}return-1},this.roundTo=function(e,t){t=Math.max(0,parseInt(t));var a=Math.pow(10,t),i=e*a;return Math.round(i)/a},this.sprintf=function(){var a=arguments,i=1;return a[0].replace(/%((%)|s|d)/g,function(e){var t=null;if(e[2])t=e[2];else{switch(t=a[i],e){case"%d":t=parseFloat(t),isNaN(t)&&(t=0)}i++}return t})},this.throttle=function(i,r,n){var s,o;return r=r||100,function(){var e=n||this,t=+new Date,a=arguments;s&&t<s+r?(clearTimeout(o),o=setTimeout(function(){s=t,i.apply(e,a)},r)):(s=t,i.apply(e,a))}},this.unique=function(e){var a=[];return R.each(e,function(e,t){-1===R.inArray(t,a)&&a.push(t)}),a},this.has_class=function(e,t){for(var a in t)if(e.hasClass(t[a]))return!0;return!1},this.is_empty=function(e){return""===R.trim(e)},this.is_empty_or_zero=function(e){return this.is_empty(e)||0==e},this.object_has_property=function(e,t){return"object"==typeof e&&null!==e&&e.hasOwnProperty(t)},this.generate_ref_id=function(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+e()+e()},this.set_ref_id=function(e){var t=this.generate_ref_id();R("#ezfc-ref-id-"+e).val(t)},this.get_calculation_routine_by_name=function(e,t){if(!e.hasOwnProperty("calculate_routine"))return!1;t=R.trim(t);var a=[];for(var i in e.calculate_routine)e.calculate_routine[i].name==t&&a.push(parseInt(i));return a},this.file_upload_attach_event=function(e,t,a,i){return""==R(e).val()||(t.files=t.originalFiles,t.submit(),R(a).attr("disabled","disabled"),i.preventDefault()),!1},this.init()},ezfc_functions={},jQuery(document).ready(function(e){EZFC=new EZFC_Object(e)}));