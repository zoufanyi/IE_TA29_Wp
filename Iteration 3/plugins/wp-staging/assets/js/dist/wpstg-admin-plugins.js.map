{"version":3,"file":"wpstg-admin-plugins.js","sources":["../src/wpstg-admin-plugins.js"],"sourcesContent":["let strict;\n\njQuery(document).ready(function($) {\n  /**\n     * DEACTIVATION FEEDBACK FORM\n     */\n  // show overlay when clicked on \"deactivate\"\n  wpstg_deactivate_link = $('.wp-admin.plugins-php tr[data-slug=\"wp-staging\"] .row-actions .deactivate a');\n  wpstg_deactivate_link_url = wpstg_deactivate_link.attr('href');\n\n  wpstg_deactivate_link.on('click', function(e) {\n    e.preventDefault();\n\n    // only show feedback form once per 30 days\n    const c_value = wpstg_admin_get_cookie('wpstg_hide_feedback');\n\n    if (c_value === undefined) {\n      $('#wpstg-feedback-overlay').show();\n    } else {\n      // click on the link\n      window.location.href = wpstg_deactivate_link_url;\n    }\n  });\n  // show text fields\n  $('#wpstg-feedback-content input[type=\"radio\"]').on('click', function() {\n    // show text field if there is one\n    $(this).parents('li').next('li').children('input[type=\"text\"], textarea').show();\n  });\n  // send form or close it\n  $('#wpstg-feedback-content .button').on('click', function(e) {\n    e.preventDefault();\n    // set cookie for 30 days\n    const exdate = new Date();\n    exdate.setSeconds(exdate.getSeconds() + 2592000);\n    document.cookie = 'wpstg_hide_feedback=1; expires=' + exdate.toUTCString() + '; path=/';\n\n    $('#wpstg-feedback-overlay').hide();\n    if ('wpstg-feedback-submit' === this.id) {\n      // Send form data\n      $.ajax({\n        type: 'POST',\n        url: ajaxurl,\n        dataType: 'json',\n        data: {\n          action: 'wpstg_send_feedback',\n          data: $('#wpstg-feedback-content form').serialize(),\n        },\n        complete: function(MLHttpRequest, textStatus, errorThrown) {\n          // deactivate the plugin and close the popup\n          $('#wpstg-feedback-overlay').remove();\n          window.location.href = wpstg_deactivate_link_url;\n        },\n      });\n    } else {\n      $('#wpstg-feedback-overlay').remove();\n      window.location.href = wpstg_deactivate_link_url;\n    }\n  });\n  // close form without doing anything\n  $('.wpstg-feedback-not-deactivate').on('click', function(e) {\n    $('#wpstg-feedback-overlay').hide();\n  });\n\n  function wpstg_admin_get_cookie(name) {\n    let i; let x; let y; const wpstg_cookies = document.cookie.split( ';' );\n    for (i = 0; i < wpstg_cookies.length; i++) {\n      x = wpstg_cookies[i].substr( 0, wpstg_cookies[i].indexOf( '=' ) );\n      y = wpstg_cookies[i].substr( wpstg_cookies[i].indexOf( '=' ) + 1 );\n      x = x.replace( /^\\s+|\\s+$/g, '' );\n      if (x === name) {\n        return unescape( y );\n      }\n    }\n  }\n});\n"],"names":["jQuery","document","ready","$","wpstg_deactivate_link","wpstg_deactivate_link_url","attr","on","e","preventDefault","c_value","wpstg_admin_get_cookie","undefined","show","window","location","href","parents","next","children","exdate","Date","setSeconds","getSeconds","cookie","toUTCString","hide","id","ajax","type","url","ajaxurl","dataType","data","action","serialize","complete","MLHttpRequest","textStatus","errorThrown","remove","name","i","x","y","wpstg_cookies","split","length","substr","indexOf","replace","unescape"],"mappings":"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"}